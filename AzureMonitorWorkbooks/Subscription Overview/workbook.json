{
    "version": "Notebook/1.0",
    "items": [
      {
        "type": 9,
        "content": {
          "version": "KqlParameterItem/1.0",
          "parameters": [
            {
              "id": "a36f0b3d-8826-4bec-95a9-70ec6cb77713",
              "version": "KqlParameterItem/1.0",
              "name": "Subscriptions",
              "type": 6,
              "isRequired": true,
              "multiSelect": true,
              "quote": "",
              "delimiter": ",",
              "value": [
                "/subscriptions/c694b35d-0b59-41aa-89ff-8fb250f0e498"
              ],
              "typeSettings": {
                "additionalResourceOptions": [
                  "value::all"
                ],
                "includeAll": true,
                "showDefault": false
              }
            },
            {
              "id": "6d44da4c-cfab-4688-8ae7-522eb0ce1b03",
              "version": "KqlParameterItem/1.0",
              "name": "LogAnalytics",
              "type": 5,
              "isRequired": true,
              "multiSelect": true,
              "quote": "'",
              "delimiter": ",",
              "query": "where type =~ 'Microsoft.OperationalInsights/workspaces'\r\n| project id",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "isHiddenWhenLocked": true,
              "typeSettings": {
                "additionalResourceOptions": [
                  "value::all"
                ]
              },
              "defaultValue": "value::all",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            {
              "id": "91477404-1ac0-4779-91ff-51587d339019",
              "version": "KqlParameterItem/1.0",
              "name": "ResourceGroups",
              "type": 5,
              "query": "resources\r\n| summarize Count = count() by resourceGroup\r\n| project Label = resourceGroup, Id = resourceGroup, Selected = Count >= 0",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "isHiddenWhenLocked": true,
              "typeSettings": {
                "additionalResourceOptions": [],
                "showDefault": false
              },
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            {
              "id": "0ef34b12-0f87-4fab-be9a-d6f3ca9cd1cd",
              "version": "KqlParameterItem/1.0",
              "name": "StorageParam",
              "type": 5,
              "query": "where type =~ 'microsoft.storage/storageaccounts'\r\n|project id",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "value": null,
              "isHiddenWhenLocked": true,
              "typeSettings": {
                "additionalResourceOptions": [],
                "showDefault": false
              },
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            {
              "id": "5c9c0253-009f-41c8-afef-6b71e145f992",
              "version": "KqlParameterItem/1.0",
              "name": "ShowHelp",
              "type": 10,
              "isRequired": true,
              "typeSettings": {
                "additionalResourceOptions": [],
                "showDefault": false
              },
              "jsonData": "[\r\n {\"value\": \"Yes\", \"label\": \"Yes\"},\r\n {\"value\": \"No\", \"label\": \"No\", \"selected\":true }\r\n]",
              "label": " Show Help"
            }
          ],
          "style": "pills",
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces"
        },
        "name": "parameters - 8"
      },
      {
        "type": 11,
        "content": {
          "version": "LinkItem/1.0",
          "style": "tabs",
          "tabStyle": "bigger",
          "links": [
            {
              "id": "64220a94-21af-40e0-b6c7-497b7f602883",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Subscription Details",
              "subTarget": "SubscriptionDetail",
              "style": "link"
            },
            {
              "id": "e79a9ba1-8aca-4e4a-9df7-83123cae1627",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Environment",
              "subTarget": "compute",
              "preText": "IaaS",
              "style": "link"
            },
            {
              "id": "9bd4447c-8cac-4e8a-9f9b-bbcc99209b13",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Networking",
              "subTarget": "network",
              "style": "link"
            },
            {
              "id": "27eb9cd3-b15e-4482-a11a-6a0f48bad55b",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Backup Report",
              "subTarget": "BackupReport",
              "style": "link"
            },
            {
              "id": "8192cd42-be72-4d18-b234-9e9fef4418dd",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Monitoring & Security",
              "subTarget": "monitor",
              "style": "link"
            },
            {
              "id": "236721e8-ddf0-47c6-a191-1ba1ae51bc2e",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Patch Management",
              "subTarget": "patchmanagement",
              "style": "link"
            },
            {
              "id": "f321b3dd-4d96-4aa7-ac57-5ad8ce236a48",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Health Overview",
              "subTarget": "HealthOverview",
              "style": "link"
            },
            {
              "id": "deddf3f5-65d8-4736-9d54-6186e044751f",
              "cellValue": "selectedTab",
              "linkTarget": "parameter",
              "linkLabel": "Resource Overview",
              "subTarget": "ResourceOverview",
              "style": "link"
            }
          ]
        },
        "name": "links - 6",
        "styleSettings": {
          "showBorder": true
        }
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Confluence Documentation Group",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## Confluence Documenation - Subscription Details"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "SubscriptionDetail"
              },
              "name": "Subscription Detail"
            },
            {
              "type": 1,
              "content": {
                "json": "## Confluence Documenation"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "compute"
              },
              "name": "Environment Documentation"
            },
            {
              "type": 1,
              "content": {
                "json": "## **Confirm the customer has not made any changes to the network**\r\n* **Confirm we have not made any changes to their environment by looking at tickets**\r\n* **Verify VPN configurations in Azure match what the customer is using**\r\n  * Public IP\r\n  * Shared Key\r\n  * Local Network\r\n* **Azure Portal (Our Responsibility)**\r\n  * Verify \"Resource Health\"\r\n    * Verify the Connection Status in Azure\r\n    * Check Resource Health\r\n      * Connection - Resource Health\r\n      * Virtual Network Gateway - Resource Health\r\n    * Run - Azure Virtual Network Gateway \"VPN Troubleshoot\" Tool\r\n  * Force Change to the Connection to verify it's health\r\n    * Change the Shared Key - In Azure and on the Customer's Device.\r\n  * Reset\r\n    * Reset Connection ( Typically a few minutes, but can take longer if the resource is unhealthy.\r\n    * Reset Virtual Network Gateway (Can take 30 Minutes)\r\n  * If Reset Doesn't work\r\n    * Delete the Connection and Virtual Network Gateway - Rebuild both from scratch\r\n      * This process can take 20 - 45 minutes depending on Azure. Take screenshots of current settings and follow our instructions\r\n* **Last Resort - Create Microsoft Support Ticket (Our Responsibility)**"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "network"
              },
              "name": "Networking Documentation"
            },
            {
              "type": 1,
              "content": {
                "json": "## How To Use This Workbook Guide"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupReport"
              },
              "name": "Backups Documentation"
            },
            {
              "type": 1,
              "content": {
                "json": "## Confluence Documenation"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "monitor"
              },
              "name": "Monitoring & Security Documentation"
            },
            {
              "type": 1,
              "content": {
                "json": "## Confluence Documenation"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "patchmanagement"
              },
              "name": "Patch Management Documentation"
            },
            {
              "type": 1,
              "content": {
                "json": "## Confluence Documenation"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "HealthOverview"
              },
              "name": "Health Overview Documenation"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "ShowHelp",
          "comparison": "isEqualTo",
          "value": "Yes"
        },
        "name": "Confluence Documentation Group"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "resourcecontainers\r\n| where type =~ \"microsoft.resources/subscriptions\"\r\n| project [\"Subscription Name\"]=id, subscriptionId, tenantId\r\n",
                "size": 4,
                "title": "Subscription Details",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "Subscription Name",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "50ch"
                      }
                    }
                  ],
                  "filter": true,
                  "sortBy": [
                    {
                      "itemKey": "tenantId",
                      "sortOrder": 1
                    }
                  ]
                },
                "sortBy": [
                  {
                    "itemKey": "tenantId",
                    "sortOrder": 1
                  }
                ]
              },
              "customWidth": "50",
              "name": "query - 0"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Heartbeat\r\n| summarize count() by Computer, RemoteIPLatitude, RemoteIPLongitude, ComputerIP",
                "size": 1,
                "title": "Virtual Machine Locations",
                "timeContext": {
                  "durationMs": 14400000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "crossComponentResources": [
                  "{LogAnalytics}"
                ],
                "visualization": "map",
                "mapSettings": {
                  "locInfo": "LatLong",
                  "latitude": "RemoteIPLatitude",
                  "longitude": "RemoteIPLongitude",
                  "sizeSettings": "count_",
                  "sizeAggregation": "Sum",
                  "maxSize": 50,
                  "minData": 100,
                  "maxData": 200,
                  "labelSettings": "Computer",
                  "legendMetric": "count_",
                  "legendAggregation": "Max",
                  "itemColorSettings": {
                    "nodeColorField": "count_",
                    "colorAggregation": "Sum",
                    "type": "thresholds",
                    "thresholdsGrid": [
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "green"
                      }
                    ]
                  }
                }
              },
              "customWidth": "25",
              "name": "query - 7"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "resources\r\n| where type == \"microsoft.network/virtualnetworks\"\r\n| extend [\"vNET IP Range\"] = properties['addressSpace']['addressPrefixes']\r\n| extend [\"DNS Server/s\"] = properties['dhcpOptions']['dnsServers']\r\n| extend Subnets0=properties['subnets'][0]['name'] \r\n| extend [\"Subnet1 IP Range\"]=properties['subnets'][0]['properties']['addressPrefix'] \r\n| extend Subnet0=strcat(Subnets0, \" / \", [\"Subnet1 IP Range\"]) \r\n| extend Subnets1=properties['subnets'][1]['name'] \r\n| extend [\"Subnet1 IP Range\"]=properties['subnets'][1]['properties']['addressPrefix'] \r\n| extend Subnet1=strcat(Subnets1, \" / \", [\"Subnet1 IP Range\"]) \r\n| extend Subnets2=properties['subnets'][2]['name'] \r\n| extend [\"Subnet1 IP Range\"]=properties['subnets'][2]['properties']['addressPrefix'] \r\n| extend Subnet2=strcat(Subnets2, \" / \", [\"Subnet1 IP Range\"])\r\n| extend Subnets3=properties['subnets'][3]['name'] \r\n| extend [\"Subnet1 IP Range\"]=properties['subnets'][3]['properties']['addressPrefix'] \r\n| extend Subnet3=strcat(Subnets3, \" / \", [\"Subnet1 IP Range\"])  \r\n| extend Subnets4=properties['subnets'][4]['name'] \r\n| extend [\"Subnet1 IP Range\"]=properties['subnets'][4]['properties']['addressPrefix'] \r\n| extend Subnet4=strcat(Subnets4, \" / \", [\"Subnet1 IP Range\"])  \r\n| extend Subnets5=properties['subnets'][5]['name'] \r\n| extend [\"Subnet1 IP Range\"]=properties['subnets'][5]['properties']['addressPrefix'] \r\n| extend Subnet5=strcat(Subnets5, \" / \", [\"Subnet1 IP Range\"])\r\n| extend SplitAll=split(properties.dhcpOptions.dnsServers, '\"')\r\n| extend DNS0=[\"DNS Server/s\"]\r\n| extend [\"vNET Peering 1\"] = properties['virtualNetworkPeerings'][0]['properties']['peeringState']\r\n| extend [\"vNET Peering 2\"] = properties['virtualNetworkPeerings'][1]['properties']['peeringState']\r\n| project [\"vNET Name\"]=id, Region=location, [\"vNET IP Range\"], [\"DNS Server/s\"], Subnet0, Subnet1, Subnet2, Subnet3, Subnet4, Subnet5, [\"vNET Peering 1\"], [\"vNET Peering 2\"], DNS0\r\n",
                "size": 4,
                "title": "Virtual Network Details",
                "exportFieldName": "DNS0",
                "exportParameterName": "DNS0",
                "exportDefaultValue": "0",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "vNET Name",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "15ch"
                      }
                    },
                    {
                      "columnMatch": "vNET IP Range",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "20ch"
                      }
                    },
                    {
                      "columnMatch": "DNS Server/s",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "Subnet0",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "25ch"
                      }
                    },
                    {
                      "columnMatch": "Subnet1",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "25ch"
                      }
                    },
                    {
                      "columnMatch": "Subnet2",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "25ch"
                      }
                    },
                    {
                      "columnMatch": "Subnet3",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "25ch"
                      }
                    },
                    {
                      "columnMatch": "Subnet4",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "25ch"
                      }
                    },
                    {
                      "columnMatch": "Subnet5",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "25ch"
                      }
                    },
                    {
                      "columnMatch": "vNET Peering 1",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Connected",
                            "representation": "yellow",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "green",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "vNET Peering 2",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Connected",
                            "representation": "yellow",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "green",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "DNS0",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "DNS1",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "DNS2",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "DNSServer",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "AddressSpace",
                      "formatter": 1
                    }
                  ],
                  "sortBy": [
                    {
                      "itemKey": "$gen_thresholds_vNET Peering 1_10",
                      "sortOrder": 2
                    }
                  ]
                },
                "sortBy": [
                  {
                    "itemKey": "$gen_thresholds_vNET Peering 1_10",
                    "sortOrder": 2
                  }
                ],
                "tileSettings": {
                  "showBorder": false
                }
              },
              "name": "query - 1"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| extend nics=array_length(properties.networkProfile.networkInterfaces)\r\n| mv-expand nic=properties.networkProfile.networkInterfaces\r\n| where nics == 1 or nic.properties.primary =~ 'true' or isempty(nic)\r\n| project vmId = id, vmName = name, vmSize=tostring(properties.hardwareProfile.vmSize), nicId = tostring(nic.id)\r\n\t| join kind=leftouter (\r\n \t\tResources\r\n  \t\t| where type =~ 'microsoft.network/networkinterfaces'\r\n  \t\t| extend ipConfigsCount=array_length(properties.ipConfigurations)\r\n  \t\t| mv-expand ipconfig=properties.ipConfigurations\r\n  \t\t| where ipConfigsCount == 1 or ipconfig.properties.primary =~ 'true'\r\n  \t\t| project nicId = id, privateIP= tostring(ipconfig.properties.privateIPAddress), publicIpId = tostring(ipconfig.properties.publicIPAddress.id), subscriptionId) on nicId\r\n| project-away nicId1\r\n| where privateIP == \"{DNS0}\"\r\n| summarize by DomainController=vmId, privateIP\r\n\r\n\r\n",
                "size": 4,
                "title": "Possible Domain Controller",
                "noDataMessage": "Select vNET Above to Show Possible Domain Controllers in this field",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ]
              },
              "customWidth": "25",
              "name": "query - 4"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "ConfigurationData \r\n| where SvcDisplayName == \"Microsoft Azure AD Sync\"\r\n| limit 1\r\n| project ServerName=_ResourceId, SvcDisplayName, SvcState\r\n\r\n",
                "size": 4,
                "title": "Azure AD Sync Service Status",
                "noDataMessage": "No Azure AD Sync Service Detected on Virtual Machine",
                "noDataMessageStyle": 4,
                "timeContext": {
                  "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "crossComponentResources": [
                  "{LogAnalytics}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "ServerName",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "20ch"
                      }
                    },
                    {
                      "columnMatch": "SvcState",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "icons",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Running",
                            "representation": "4",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "success",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              "customWidth": "35",
              "name": "query - 5"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "resources\r\n| where type =~ \"microsoft.aad/domainservices\"\r\n| extend DomainControllerIPs=properties['replicaSets'][0]['domainControllerIpAddress']\r\n| extend ServiceStatus=properties['replicaSets'][0]['serviceStatus']\r\n| project [\"Azure AD Domain Services Name\"]=id, DomainControllerIPs, ServiceStatus",
                "size": 4,
                "title": "Azure AD Domain Services",
                "noDataMessage": "The Azure AD Domain Service Resource Was Not Detected Inside The Subscription",
                "noDataMessageStyle": 4,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "Azure AD Domain Services Name",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "30ch"
                      }
                    },
                    {
                      "columnMatch": "DomainControllerIPs",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "ServiceStatus",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "icons",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Running",
                            "representation": "4",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "success",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              "customWidth": "40",
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "resources\r\n| where type == \"microsoft.desktopvirtualization/hostpools\"\r\n| project [\"Host Pool Name\"]=id, location, resourceGroup, LBType=properties.loadBalancerType, SeesionLimit=properties.maxSessionLimit, HostPoolType=properties.hostPoolType, name",
                "size": 4,
                "title": "AVD Host Pool Overview",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "LBType",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "SeesionLimit",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "HostPoolType",
                      "formatter": 1
                    }
                  ]
                }
              },
              "customWidth": "60",
              "name": "query - 3"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "SubscriptionDetail"
        },
        "name": "SubscriptionDetails-Group"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Environment Group",
          "items": [
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "a5b84469-ab4c-4b30-9983-22c454d61468",
                    "cellValue": "compute",
                    "linkTarget": "parameter",
                    "linkLabel": "Azure Compute",
                    "subTarget": "azure",
                    "style": "link"
                  },
                  {
                    "id": "b7dca9b8-21e5-4521-ac27-63088ed14ec6",
                    "cellValue": "compute",
                    "linkTarget": "parameter",
                    "linkLabel": "AVD Host Pools",
                    "subTarget": "AVDHostPools",
                    "style": "link"
                  },
                  {
                    "id": "d44b3ab8-d86b-4c5c-939f-273554437a4e",
                    "cellValue": "compute",
                    "linkTarget": "parameter",
                    "linkLabel": "Azure Storage",
                    "subTarget": "arc",
                    "style": "link"
                  },
                  {
                    "id": "be29462a-d666-402a-ac69-375afddc75da",
                    "cellValue": "compute",
                    "linkTarget": "parameter",
                    "linkLabel": "VM Disk Storage",
                    "subTarget": "VMDisk",
                    "style": "link"
                  },
                  {
                    "id": "ac6dabf6-26c3-4449-bb3b-c656f4957591",
                    "cellValue": "compute",
                    "linkTarget": "parameter",
                    "linkLabel": "Platform Software Version",
                    "subTarget": "PlatformSoftwareVersion",
                    "style": "link"
                  },
                  {
                    "id": "eff0a62a-0e6c-4304-8147-1a16f966660c",
                    "cellValue": "compute",
                    "linkTarget": "parameter",
                    "linkLabel": "VM History",
                    "subTarget": "VMHistory",
                    "style": "link"
                  }
                ]
              },
              "name": "tabs -  Compute"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources | where type == \"microsoft.compute/virtualmachines\"\r\n| extend vmState = tostring(properties.extended.instanceView.powerState.displayStatus)\r\n| extend vmState = iif(isempty(vmState), \"VM State Unknown\", (vmState))\r\n| summarize count() by vmState",
                "size": 4,
                "title": "VM Status",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "piechart",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmState",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 2,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                },
                "chartSettings": {
                  "seriesLabelSettings": [
                    {
                      "seriesName": "VM running",
                      "color": "green"
                    },
                    {
                      "seriesName": "VM stopped",
                      "color": "redBright"
                    }
                  ]
                },
                "mapSettings": {
                  "locInfo": "LatLong",
                  "sizeSettings": "count_",
                  "sizeAggregation": "Sum",
                  "legendMetric": "count_",
                  "legendAggregation": "Sum",
                  "itemColorSettings": {
                    "type": "heatmap",
                    "colorAggregation": "Sum",
                    "nodeColorField": "count_",
                    "heatmapPalette": "greenRed"
                  }
                }
              },
              "customWidth": "25",
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "azure"
              },
              "name": "query - Azure Compute Summary - Copy"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources | where type == \"microsoft.compute/virtualmachines\"\r\n| extend vmSize = tostring(properties.hardwareProfile.vmSize)\r\n| summarize count() by vmSize",
                "size": 4,
                "title": "VM Sizes",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "piechart",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmState",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 2,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                },
                "mapSettings": {
                  "locInfo": "LatLong",
                  "sizeSettings": "count_",
                  "sizeAggregation": "Sum",
                  "legendMetric": "count_",
                  "legendAggregation": "Sum",
                  "itemColorSettings": {
                    "type": "heatmap",
                    "colorAggregation": "Sum",
                    "nodeColorField": "count_",
                    "heatmapPalette": "greenRed"
                  }
                }
              },
              "customWidth": "25",
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "azure"
              },
              "name": "query - Azure Compute Summary - Copy - Copy"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources | where type == \"microsoft.compute/virtualmachines\"\r\n| extend DiskSku = tostring(properties.storageProfile.osDisk.managedDisk.storageAccountType)\r\n| summarize count() by DiskSku",
                "size": 4,
                "title": "Disk Types",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "piechart",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmState",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 2,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                },
                "chartSettings": {
                  "seriesLabelSettings": [
                    {
                      "seriesName": "StandardSSD_LRS",
                      "color": "blue"
                    },
                    {
                      "seriesName": "Standard_LRS",
                      "color": "orange"
                    },
                    {
                      "seriesName": "Premium_LRS",
                      "color": "green"
                    }
                  ]
                },
                "mapSettings": {
                  "locInfo": "LatLong",
                  "sizeSettings": "count_",
                  "sizeAggregation": "Sum",
                  "legendMetric": "count_",
                  "legendAggregation": "Sum",
                  "itemColorSettings": {
                    "type": "heatmap",
                    "colorAggregation": "Sum",
                    "nodeColorField": "count_",
                    "heatmapPalette": "greenRed"
                  }
                }
              },
              "customWidth": "30",
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "azure"
              },
              "name": "query - Azure Compute Summary - Copy - Copy - Copy"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources | where type == \"microsoft.compute/virtualmachines\"\r\n| extend [\"Azure Spot Eviction Policy\"] = tostring(properties.evictionPolicy)\r\n| where [\"Azure Spot Eviction Policy\"] == \"Deallocate\" or [\"Azure Spot Eviction Policy\"] == \"Delete\"\r\n| summarize count() by [\"Azure Spot Eviction Policy\"]\r\n",
                "size": 4,
                "title": "Azure Spot VMs",
                "noDataMessage": "No Azure Spot Instances Detected",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "piechart",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmState",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 2,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                },
                "chartSettings": {
                  "seriesLabelSettings": [
                    {
                      "seriesName": "StandardSSD_LRS",
                      "color": "blue"
                    },
                    {
                      "seriesName": "Standard_LRS",
                      "color": "orange"
                    },
                    {
                      "seriesName": "Premium_LRS",
                      "color": "green"
                    }
                  ]
                },
                "mapSettings": {
                  "locInfo": "LatLong",
                  "sizeSettings": "count_",
                  "sizeAggregation": "Sum",
                  "legendMetric": "count_",
                  "legendAggregation": "Sum",
                  "itemColorSettings": {
                    "type": "heatmap",
                    "colorAggregation": "Sum",
                    "nodeColorField": "count_",
                    "heatmapPalette": "greenRed"
                  }
                }
              },
              "customWidth": "15",
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "azure"
              },
              "name": "query - Azure Compute Summary - Copy - Copy - Copy - Copy"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| project vmName = id, Status=properties.extended.instanceView.powerState.displayStatus, location, resourceGroup, vmSize=properties.hardwareProfile.vmSize, DiskSize=properties.storageProfile.osDisk.diskSizeGB, DiskSku=properties.storageProfile.osDisk.managedDisk.storageAccountType, DiskCaching=properties.storageProfile.osDisk.caching, OS=properties.extended.instanceView.osName, OSVersion=properties.extended.instanceView.osVersion, LicenseType=properties.licenseType, [\"Azure Spot Eviction Policy\"]=properties.evictionPolicy, subscriptionId\r\n| sort by vmName\r\n\r\n\r\n//| project name, properties.priority, properties.evictionPolicy\r\n\r\n//Resources \r\n//| where type == \"microsoft.compute/virtualmachines\"\r\n//| project id, location, resourceGroup, properties.hardwareProfile.vmSize\r\n",
                "size": 0,
                "title": "Virtual Machines in Subscription",
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "Status",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "VM running",
                            "representation": "redBright",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "green",
                            "text": "{0}{1}"
                          }
                        ],
                        "customColumnWidthSetting": "18ch"
                      }
                    },
                    {
                      "columnMatch": "location",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "18ch"
                      }
                    },
                    {
                      "columnMatch": "resourceGroup",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "20ch"
                      }
                    },
                    {
                      "columnMatch": "vmSize",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "DiskSize",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "14ch"
                      }
                    },
                    {
                      "columnMatch": "DiskSku",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "StandardSSD_LRS",
                            "representation": "lightBlue",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "==",
                            "thresholdValue": "Premium_LRS",
                            "representation": "green",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "==",
                            "thresholdValue": "Standard_LRS",
                            "representation": "yellow",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "DiskCaching",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "OS",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "20ch"
                      }
                    },
                    {
                      "columnMatch": "LicenseType",
                      "formatter": 1,
                      "formatOptions": {
                        "customColumnWidthSetting": "20ch"
                      }
                    },
                    {
                      "columnMatch": "Azure Spot Eviction Policy",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "deallocate",
                            "representation": "orange",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    }
                  ],
                  "rowLimit": 1000,
                  "filter": true,
                  "sortBy": [
                    {
                      "itemKey": "vmSize",
                      "sortOrder": 1
                    }
                  ]
                },
                "sortBy": [
                  {
                    "itemKey": "vmSize",
                    "sortOrder": 1
                  }
                ],
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmState",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 2,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "azure"
              },
              "showPin": true,
              "name": "query - Azure Compute Summary - Copy - Copy"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "resources\r\n| where type == \"microsoft.desktopvirtualization/hostpools\"\r\n| project Customer=subscriptionId, [\"Host Pool Name\"]=id, Description=properties.description, location, resourceGroup, LBType=properties.loadBalancerType, SessionLimit=properties.maxSessionLimit, HostPoolType=properties.hostPoolType, name",
                "size": 1,
                "title": "Host Pools",
                "exportedParameters": [
                  {
                    "fieldName": "name",
                    "parameterName": "HostPoolName"
                  },
                  {
                    "fieldName": "resourceGroup",
                    "parameterName": "rgparamater",
                    "parameterType": 1
                  },
                  {
                    "fieldName": "SessionLimit",
                    "parameterName": "SessionLimit",
                    "parameterType": 1
                  }
                ],
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true,
                        "customColumnWidthSetting": "50ch"
                      }
                    },
                    {
                      "columnMatch": "Customer",
                      "formatter": 5,
                      "formatOptions": {
                        "linkTarget": "Resource"
                      }
                    },
                    {
                      "columnMatch": "LBType",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "SessionLimit",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "HostPoolType",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Pooled",
                            "representation": "lightBlue",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "name",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "SeesionLimit",
                      "formatter": 1
                    }
                  ],
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "Customer"
                    ],
                    "expandTopLevel": true
                  }
                },
                "sortBy": []
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "AVDHostPools"
              },
              "name": "query - 106"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "desktopvirtualizationresources\r\n| where type == \"microsoft.desktopvirtualization/hostpools/sessionhosts\"\r\n| extend SplitAll=split(name,'/')\r\n| extend HostPool = SplitAll[0]\r\n| extend SessionHostNameSplit = tostring(SplitAll[1])\r\n| extend SplitAll2=split(SessionHostNameSplit,'.')\r\n| extend SessionHostName = tostring(SplitAll2[0])\r\n| extend SessionLimit={SessionLimit}\r\n| where HostPool == \"{HostPoolName}\"\r\n| where resourceGroup == \"{rgparamater}\"\r\n| project id, SessionHostName, Status=properties.status, Sessions=properties.sessions, SessionLimit, AllowSessions=properties.allowNewSession, AssignedUser=properties.assignedUser, OS=properties.osVersion, UpdateStatus=properties.updateStatus, UpdateState=properties.updateState, SxSVersion=properties.sxSStackVersion, ImageType=properties.imageType\r\n\t| join kind=leftouter(\r\nResources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| extend SplitAll=split(name, '.')\r\n| extend SessionHostName=tostring(SplitAll[0])\r\n| project SessionHostName, VMStatus=properties.extended.instanceView.powerState.displayStatus) on SessionHostName\r\n| project SessionHostName, VMStatus, Status, Sessions, SessionLimit, AllowSessions, AssignedUser, OS, UpdateStatus, UpdateState, SxSVersion, ImageType\r\n| sort by SessionHostName",
                "size": 3,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "VMStatus",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "icons",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "VM running",
                            "representation": "2",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "success",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "Status",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Available",
                            "representation": "redBright",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "green",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "Sessions",
                      "formatter": 8,
                      "formatOptions": {
                        "min": 0,
                        "max": 10,
                        "palette": "redBright"
                      }
                    },
                    {
                      "columnMatch": "AllowSessions",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "false",
                            "representation": "redBright",
                            "text": "Not Allowed"
                          },
                          {
                            "operator": "==",
                            "thresholdValue": "true",
                            "representation": "green",
                            "text": "Allowed"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "green",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "AssignedUser",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "null",
                            "representation": "lightBlue",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "OS",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "UpdateStatus",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "icons",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "NotInProgress",
                            "representation": "2",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "success",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "UpdateState",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "icons",
                        "thresholdsGrid": [
                          {
                            "operator": "!=",
                            "thresholdValue": "Succeeded",
                            "representation": "2",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "success",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "SxSVersion",
                      "formatter": 1
                    }
                  ],
                  "filter": true
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "AVDHostPools"
              },
              "name": "query - 24"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "where type =~ \"microsoft.storage/storageaccounts\"\r\n| extend AuthenticationSource = properties.azureFilesIdentityBasedAuthentication.directoryServiceOptions\r\n| extend DomainName= properties.azureFilesIdentityBasedAuthentication.activeDirectoryProperties.domainName\r\n//| extend Pack=pack_all()\r\n//| project properties\r\n| project Customer=subscriptionId, id, Path = properties['primaryEndpoints'][0]['file'], kind, location, resourceGroup, sku.tier, PrivateEndpoint=properties.privateEndpointConnections[0]['properties']['privateEndpoint']['id'], AuthenticationSource, DomainName\r\n",
                "size": 1,
                "title": "Azure Files Storage",
                "noDataMessage": "No Azure Files Storage Detected",
                "exportFieldName": "id",
                "exportParameterName": "AzureFilesid",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "Customer",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true,
                        "customColumnWidthSetting": "50ch"
                      }
                    },
                    {
                      "columnMatch": "sku_tier",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "colors",
                        "thresholdsGrid": [
                          {
                            "operator": "==",
                            "thresholdValue": "Standard",
                            "representation": "blue",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "green",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    },
                    {
                      "columnMatch": "PrivateEndpoint",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "AuthenticationSource",
                      "formatter": 1
                    },
                    {
                      "columnMatch": "DomainName",
                      "formatter": 1
                    }
                  ]
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "arc"
              },
              "name": "query - 106"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "where type =~ 'Microsoft.NetApp/netAppAccounts/capacityPools/volumes'\r\n| mvexpand Mountpoint = properties.['mountTargets']\r\n| extend MountP = Mountpoint.smbServerFqdn\r\n| extend VolumeP=properties.creationToken\r\n| project Customer=subscriptionId, id, MountPath=strcat(@\"\\\\\", MountP, @\"\\\", VolumeP), Tier = properties.serviceLevel, PrivateIP = properties['mountTargets'][0]['ipAddress']\r\n",
                "size": 1,
                "title": "Azure NetApp Files Storage",
                "noDataMessage": "No Azure NetApp Files Detected",
                "exportFieldName": "id",
                "exportParameterName": "ANFid",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "Customer",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true,
                        "customColumnWidthSetting": "50ch"
                      }
                    },
                    {
                      "columnMatch": "id",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "48ch"
                      }
                    },
                    {
                      "columnMatch": "Mountpoint",
                      "formatter": 0,
                      "formatOptions": {
                        "customColumnWidthSetting": "60ch"
                      }
                    }
                  ]
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  "leftContent": {
                    "columnMatch": "Count",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto",
                      "showIcon": true
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "arc"
              },
              "name": "query - ARC Machines Inventory"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "parameters": [
                  {
                    "id": "d3f114c3-4376-47d0-ae60-8b9384219ce5",
                    "version": "KqlParameterItem/1.0",
                    "name": "AzureFilesAccount",
                    "type": 5,
                    "multiSelect": true,
                    "quote": "'",
                    "delimiter": ",",
                    "query": "resources\r\n| where type =~ \"microsoft.storage/storageaccounts\"\r\n| where id =~ \"{AzureFilesid}\"\r\n| project id",
                    "crossComponentResources": [
                      "{Subscriptions}"
                    ],
                    "isHiddenWhenLocked": true,
                    "typeSettings": {
                      "additionalResourceOptions": [
                        "value::all"
                      ],
                      "showDefault": false
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "defaultValue": "value::all",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  {
                    "id": "60d2f5b9-d51e-499f-8d4b-7009772eb95c",
                    "version": "KqlParameterItem/1.0",
                    "name": "AzureNetAppFiles",
                    "type": 5,
                    "isRequired": true,
                    "multiSelect": true,
                    "quote": "'",
                    "delimiter": ",",
                    "query": "where type =~ 'Microsoft.NetApp/netAppAccounts/capacityPools/volumes'\r\n| where id =~ \"{ANFid}\"\r\n| project id\r\n",
                    "crossComponentResources": [
                      "{Subscriptions}"
                    ],
                    "isHiddenWhenLocked": true,
                    "typeSettings": {
                      "additionalResourceOptions": [
                        "value::all"
                      ],
                      "showDefault": false
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "defaultValue": "value::all",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  }
                ],
                "style": "pills",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources"
              },
              "name": "parameters - 15"
            },
            {
              "type": 10,
              "content": {
                "chartId": "workbookbd430827-61fb-4211-817c-acccbc4232d2",
                "version": "MetricsItem/2.0",
                "size": 0,
                "chartType": 2,
                "resourceType": "microsoft.storage/storageaccounts",
                "metricScope": 0,
                "resourceParameter": "AzureFilesAccount",
                "resourceIds": [
                  "{AzureFilesAccount}"
                ],
                "timeContext": {
                  "durationMs": 172800000
                },
                "metrics": [
                  {
                    "namespace": "microsoft.storage/storageaccounts",
                    "metric": "microsoft.storage/storageaccounts-Transaction-SuccessE2ELatency",
                    "aggregation": 4,
                    "splitBy": null
                  },
                  {
                    "namespace": "microsoft.storage/storageaccounts",
                    "metric": "microsoft.storage/storageaccounts-Transaction-SuccessServerLatency",
                    "aggregation": 4
                  }
                ],
                "title": "Azure Files Storage Metrics",
                "showOpenInMe": true,
                "gridSettings": {
                  "rowLimit": 10000
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "arc"
              },
              "name": "metric - 16"
            },
            {
              "type": 10,
              "content": {
                "chartId": "workbookbd430827-61fb-4211-817c-acccbc4232d2",
                "version": "MetricsItem/2.0",
                "size": 0,
                "chartType": 2,
                "resourceType": "microsoft.storage/storageaccounts",
                "metricScope": 0,
                "resourceParameter": "AzureFilesAccount",
                "resourceIds": [
                  "{AzureFilesAccount}"
                ],
                "timeContext": {
                  "durationMs": 43200000
                },
                "metrics": [
                  {
                    "namespace": "microsoft.storage/storageaccounts/fileservices",
                    "metric": "microsoft.storage/storageaccounts/fileservices-Capacity-FileShareCapacityQuota",
                    "aggregation": 4,
                    "splitBy": null
                  },
                  {
                    "namespace": "microsoft.storage/storageaccounts/fileservices",
                    "metric": "microsoft.storage/storageaccounts/fileservices-Capacity-FileCapacity",
                    "aggregation": 4
                  }
                ],
                "title": "Azure Files Storage Usage",
                "showOpenInMe": true,
                "gridSettings": {
                  "rowLimit": 10000
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "arc"
              },
              "name": "metric - 16 - Copy"
            },
            {
              "type": 10,
              "content": {
                "chartId": "workbook8c0e9fb0-f197-4481-a280-a4fa0c8c00c4",
                "version": "MetricsItem/2.0",
                "size": 0,
                "chartType": 2,
                "resourceType": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                "metricScope": 0,
                "resourceParameter": "AzureNetAppFiles",
                "resourceIds": [
                  "{AzureNetAppFiles}"
                ],
                "timeContext": {
                  "durationMs": 86400000
                },
                "metrics": [
                  {
                    "namespace": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                    "metric": "microsoft.netapp/netappaccounts/capacitypools/volumes--AverageReadLatency",
                    "aggregation": 4,
                    "splitBy": null
                  },
                  {
                    "namespace": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                    "metric": "microsoft.netapp/netappaccounts/capacitypools/volumes--AverageWriteLatency",
                    "aggregation": 4
                  }
                ],
                "title": "Azure NetApp Files Metrics",
                "showOpenInMe": true,
                "gridSettings": {
                  "rowLimit": 10000
                }
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "arc"
              },
              "name": "metric - 17"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "VM Disk Storage",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Perf\r\n| where CounterName == '% Free Space'\r\n| summarize arg_max(TimeGenerated, *) by Computer, CounterName, InstanceName\r\n| summarize AggregatedValue1 = avg(CounterValue) by Computer, bin(TimeGenerated, 15m),CounterName,InstanceName\r\n| extend PercFreespace = AggregatedValue1\r\n| join (\r\nPerf\r\n| where CounterName == 'Free Megabytes'\r\n| summarize arg_max(TimeGenerated, *) by Computer, CounterName, InstanceName\r\n| summarize AggregatedValue2 = avg(CounterValue) by Computer, bin(TimeGenerated, 15m),CounterName,InstanceName\r\n| extend FreeMB = AggregatedValue2\r\n) on Computer , InstanceName\r\n| where strlen(InstanceName) ==2 and InstanceName contains ':'\r\n| extend PercUsedSpace = 100-PercFreespace\r\n| extend TotalSizeofDiskinMB = (FreeMB * 100)/PercFreespace\r\n| where InstanceName !contains 'D' and PercUsedSpace > 80\r\n| project Computer , PercFreespace , PercUsedSpace, FreeMB, TimeGenerated, InstanceName, TotalSizeofDiskinMB , TotaUsedMB = TotalSizeofDiskinMB-FreeMB\r\n| sort by Computer",
                      "size": 4,
                      "title": "All Disks Above 80% Usage",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "PercFreespace",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 1,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "PercUsedSpace",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 50,
                              "max": 100,
                              "palette": "redBright"
                            },
                            "numberFormat": {
                              "unit": 1,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "FreeMB",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 4,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "TotalSizeofDiskinMB",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 4,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "TotaUsedMB",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 4,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "name": "query - 21 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Perf\r\n| where CounterName == '% Free Space'\r\n| summarize arg_max(TimeGenerated, *) by Computer, CounterName, InstanceName\r\n| summarize AggregatedValue1 = avg(CounterValue) by Computer, bin(TimeGenerated, 15m),CounterName,InstanceName\r\n| extend PercFreespace = AggregatedValue1\r\n| join (\r\nPerf\r\n| where CounterName == 'Free Megabytes'\r\n| summarize arg_max(TimeGenerated, *) by Computer, CounterName, InstanceName\r\n| summarize AggregatedValue2 = avg(CounterValue) by Computer, bin(TimeGenerated, 15m),CounterName,InstanceName\r\n| extend FreeMB = AggregatedValue2\r\n) on Computer , InstanceName\r\n| where strlen(InstanceName) ==2 and InstanceName contains ':'\r\n| extend PercUsedSpace = 100-PercFreespace\r\n| extend TotalSizeofDiskinMB = (FreeMB * 100)/PercFreespace\r\n//| where InstanceName !contains 'D' and PercUsedSpace > 30\r\n| where InstanceName !contains 'D'\r\n| project Computer , PercFreespace , PercUsedSpace, FreeMB, TimeGenerated, InstanceName, TotalSizeofDiskinMB , TotaUsedMB = TotalSizeofDiskinMB-FreeMB\r\n| sort by Computer",
                      "size": 3,
                      "title": "All Disk Usage Grouped By Computer",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Computer",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "PercFreespace",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 1,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "PercUsedSpace",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 50,
                              "max": 100,
                              "palette": "redBright"
                            },
                            "numberFormat": {
                              "unit": 1,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "FreeMB",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 4,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "TotalSizeofDiskinMB",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 4,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "TotaUsedMB",
                            "formatter": 0,
                            "numberFormat": {
                              "unit": 4,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          }
                        ],
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "Computer"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "InstanceName"
                        }
                      },
                      "sortBy": []
                    },
                    "name": "query - 21"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Perf \r\n| where ObjectName == \"LogicalDisk\"\r\n| where InstanceName !contains 'Harddisk' and InstanceName !contains '_Total' and InstanceName !contains 'D:'\r\n| where CounterName == \"% Free Space\" \r\n| summarize arg_max(TimeGenerated, *) by InstanceName, Computer\r\n// arg_max over TimeGenerated returns the latest record \r\n| project TimeGenerated, Computer, InstanceName, CounterValue",
                      "size": 0,
                      "timeContext": {
                        "durationMs": 3600000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "CounterValue",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 0,
                              "max": 100,
                              "palette": "redGreen"
                            }
                          }
                        ],
                        "sortBy": [
                          {
                            "itemKey": "InstanceName",
                            "sortOrder": 1
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "InstanceName",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "name": "query - 3"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "VMDisk"
              },
              "name": "group - VMDiskStorage"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "PlatformSoftwareVersion",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "ConfigurationData\r\n| where ConfigDataType == \"Software\"\r\n| where SoftwareName =~ \"Microsoft FSLogix Apps\" or SoftwareName =~ \"Microsoft Azure AD Connect\" or SoftwareName =~ \"Microsoft Azure AD Connect Health agent for sync\"\r\n//| where SoftwareName has \"azure ad\"\r\n| summarize by Computer, SoftwareName, CurrentVersion\r\n| sort by Computer\r\n",
                      "size": 0,
                      "timeContext": {
                        "durationMs": 43200000
                      },
                      "showExportToExcel": true,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "SoftwareName",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "CurrentVersion",
                            "formatter": 0,
                            "formatOptions": {
                              "aggregation": "Max"
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "SoftwareName"
                          ],
                          "expandTopLevel": true
                        },
                        "sortBy": [
                          {
                            "itemKey": "CurrentVersion",
                            "sortOrder": 2
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "CurrentVersion",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "name": "query - 0"
                  },
                  {
                    "type": 1,
                    "content": {
                      "json": "### [FSLogix Current Version](https://docs.microsoft.com/en-us/fslog** \r\n\r\n**PowerShell Command to Gather Registry Keys - Get-ItemProperty -Path HKLM:\\SOFTWARE\\FSLogixix/whats-new)   **2.9.8361.52326 - As of 12/13/2022**\r\nFSLogix - 2.9.8361.52326  - 12/13/2022 ||||\r\nFSLogix - 2.9.8228.50276  - 7/21/2022 ||||\r\nFSLogix - 2.9.8171.14983  - 5/24/2022 ||||\r\nFSLogix - 2.9.8111.53415  - 3/25/2022 ||||\r\nFSLogix - 2.9.7979.62170  - 5/3/2022 ||||\r\nFSLogix - 2.9.7838.44363  - 5/24/2022 ||||\r\n\r\n### [Azure AD Connect Versions](https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-version-history)   **2.1.1.0 - As of 6/8/2022**\r\n\r\n**Profiles**"
                    },
                    "name": "text - 1"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "ConfigurationData\r\n| where ConfigDataType == \"Software\"\r\n| where SoftwareName =~ \"Microsoft FSLogix Apps\"\r\n//| where CurrentVersion == \"2.9.8361.52326\"\r\n| extend SubscriptionId = tostring(split(_ResourceId, \"/\")[2])\r\n| summarize dcount(Computer) by Computer, SoftwareName, CurrentVersion, SubscriptionId\r\n| project Computer, Total=dcount_Computer, SoftwareName, CurrentVersion, SubscriptionId\r\n| sort by Computer\r\n",
                      "size": 3,
                      "timeContext": {
                        "durationMs": 43200000
                      },
                      "exportFieldName": "Computer",
                      "exportParameterName": "ComputerParam",
                      "showExportToExcel": true,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Total",
                            "formatter": 0,
                            "formatOptions": {
                              "aggregation": "Sum"
                            }
                          },
                          {
                            "columnMatch": "SoftwareName",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "CurrentVersion",
                            "formatter": 1,
                            "formatOptions": {
                              "aggregation": "Max"
                            }
                          },
                          {
                            "columnMatch": "dcount_Computer",
                            "formatter": 0,
                            "formatOptions": {
                              "aggregation": "Sum"
                            }
                          }
                        ],
                        "rowLimit": 500,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "CurrentVersion",
                            "SubscriptionId"
                          ],
                          "expandTopLevel": false,
                          "finalBy": "SubscriptionId"
                        },
                        "sortBy": [
                          {
                            "itemKey": "CurrentVersion",
                            "sortOrder": 2
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "CurrentVersion",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "name": "query - 0 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "ConfigurationData\r\n| where ConfigDataType == \"Software\"\r\n| where SoftwareName =~ \"Microsoft FSLogix Apps\"\r\n| where CurrentVersion == \"2.9.8361.52326\"\r\n| extend SubscriptionId = tostring(split(_ResourceId, \"/\")[2])\r\n| where Computer contains \"{ComputerParam}\"\r\n| summarize by Computer, SoftwareName, CurrentVersion, SubscriptionId\r\n| sort by Computer\r\n",
                      "size": 3,
                      "title": "Last 30 Days",
                      "timeContext": {
                        "durationMs": 2592000000
                      },
                      "showExportToExcel": true,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "SoftwareName",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "CurrentVersion",
                            "formatter": 0,
                            "formatOptions": {
                              "aggregation": "Max"
                            }
                          }
                        ],
                        "rowLimit": 500,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "SubscriptionId"
                          ],
                          "expandTopLevel": true
                        },
                        "sortBy": [
                          {
                            "itemKey": "CurrentVersion",
                            "sortOrder": 2
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "CurrentVersion",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "name": "query - 0 - Copy - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "PlatformSoftwareVersion"
              },
              "name": "PlatformSoftwareVersion"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "VM History Group",
                "items": [
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "crossComponentResources": [
                        "{LogAnalytics_Admin}"
                      ],
                      "parameters": [
                        {
                          "id": "cadc5727-6273-4ebb-874a-7d8891687678",
                          "version": "KqlParameterItem/1.0",
                          "name": "LogAnalytics_Admin",
                          "type": 5,
                          "isRequired": true,
                          "multiSelect": true,
                          "quote": "'",
                          "delimiter": ",",
                          "query": "where type =~ 'Microsoft.OperationalInsights/workspaces'\r\n| where name contains \"PlatformLogs\" or name contains 'VDMS-ADMIN'\r\n| project id",
                          "crossComponentResources": [
                            "value::all"
                          ],
                          "isHiddenWhenLocked": true,
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::all"
                            ],
                            "showDefault": false
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "defaultValue": "value::all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        {
                          "id": "f7a13007-ee01-41b4-bc1e-44749ae878a8",
                          "version": "KqlParameterItem/1.0",
                          "name": "TimeGenerated",
                          "type": 4,
                          "isRequired": true,
                          "typeSettings": {
                            "selectableValues": [
                              {
                                "durationMs": 1800000
                              },
                              {
                                "durationMs": 3600000
                              },
                              {
                                "durationMs": 14400000
                              },
                              {
                                "durationMs": 43200000
                              },
                              {
                                "durationMs": 86400000
                              },
                              {
                                "durationMs": 172800000
                              },
                              {
                                "durationMs": 259200000
                              },
                              {
                                "durationMs": 604800000
                              },
                              {
                                "durationMs": 1209600000
                              },
                              {
                                "durationMs": 2592000000
                              },
                              {
                                "durationMs": 5184000000
                              },
                              {
                                "durationMs": 7776000000
                              }
                            ]
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "value": {
                            "durationMs": 5184000000
                          }
                        },
                        {
                          "id": "260aec67-d86f-4f1b-897f-75816ff00ff0",
                          "version": "KqlParameterItem/1.0",
                          "name": "VMName",
                          "label": "VM Name",
                          "type": 5,
                          "isRequired": true,
                          "multiSelect": true,
                          "quote": "'",
                          "delimiter": ",",
                          "query": "VMTracking_CL\r\n| where SubscriptionId == '{Subscriptions:id}'\r\n| extend VMName=split(vmName_s,'/')[8]\r\n| extend tostring(VMName)\r\n| summarize by VMName\r\n\r\n\r\n",
                          "crossComponentResources": [
                            "{LogAnalytics_Admin}"
                          ],
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::all"
                            ],
                            "showDefault": false
                          },
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeGenerated",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "value": [
                            "vm-0002f35aab33"
                          ]
                        },
                        {
                          "version": "KqlParameterItem/1.0",
                          "name": "VMStatus",
                          "type": 5,
                          "isRequired": true,
                          "multiSelect": true,
                          "quote": "'",
                          "delimiter": ",",
                          "query": "VMTracking_CL\r\n| where SubscriptionId == '{Subscriptions:id}'\r\n| summarize by Status_s\r\n\r\n\r\n",
                          "crossComponentResources": [
                            "{LogAnalytics_Admin}"
                          ],
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::all"
                            ],
                            "showDefault": false
                          },
                          "timeContext": {
                            "durationMs": 0
                          },
                          "timeContextFromParameter": "TimeGenerated",
                          "defaultValue": "value::all",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "id": "6dbb3b6b-2d2a-45d1-afba-a4a5e1ad6f24"
                        }
                      ],
                      "style": "pills",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces"
                    },
                    "name": "parameters - 0"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "VMTracking_CL\r\n| where SubscriptionId == '{Subscriptions:id}'\r\n| extend VMNames=split(vmName_s,'/')[8]\r\n| where VMNames in ({VMName}) or '*' in ({VMName})\r\n| where Status_s in ({VMStatus}) or '*' in ({VMStatus})\r\n| project TimeGenerated, vmName_s, Status_s, location_s, vmSize_s, OSDiskSize_s, OSDiskSku_s, DiskCaching_s, OS_s, OSVersion_s, LicenseType_s, AzureSpotEvictionPolicy_s, SubscriptionId, AutoUpdates_s\r\n| sort by TimeGenerated",
                      "size": 0,
                      "timeContextFromParameter": "TimeGenerated",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics_Admin}"
                      ],
                      "gridSettings": {
                        "rowLimit": 5000,
                        "filter": true
                      }
                    },
                    "name": "query - 1"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "VMTracking_CL\r\n| where SubscriptionId == '{Subscriptions:id}'\r\n| extend VMNames=split(vmName_s,'/')[8]\r\n| extend tostring(VMNames)\r\n| where VMNames in ({VMName}) or '*' in ({VMName})\r\n| where Status_s in ({VMStatus}) or '*' in ({VMStatus})\r\n| summarize count() by bin(TimeGenerated, 10min), VMNames\r\n//| project TimeGenerated, VMNames\r\n",
                      "size": 0,
                      "aggregation": 1,
                      "timeContextFromParameter": "TimeGenerated",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics_Admin}"
                      ],
                      "visualization": "scatterchart",
                      "gridSettings": {
                        "rowLimit": 5000,
                        "filter": true
                      },
                      "graphSettings": {
                        "type": 0
                      }
                    },
                    "name": "query - 1 - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "VMHistory"
              },
              "name": "group - VMHistory"
            },
            {
              "type": 1,
              "content": {
                "json": "## VMs by Storage and Networking"
              },
              "conditionalVisibilities": [
                {
                  "parameterName": "selectedTab",
                  "comparison": "isEqualTo",
                  "value": "compute"
                },
                {
                  "parameterName": "compute",
                  "comparison": "isEqualTo",
                  "value": "azure"
                }
              ],
              "name": "text - Azure Compute - Copy"
            },
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "ac392a07-01a6-4727-b82b-117c529867c7",
                    "cellValue": "hardware",
                    "linkTarget": "parameter",
                    "linkLabel": "Networking",
                    "subTarget": "network",
                    "style": "link"
                  },
                  {
                    "id": "9ba284c0-ba39-460c-9f74-b9ae8845245c",
                    "cellValue": "hardware",
                    "linkTarget": "parameter",
                    "linkLabel": "Storage",
                    "subTarget": "storage",
                    "style": "link"
                  },
                  {
                    "id": "74bab549-0028-4018-8bf3-065b6c6fa28e",
                    "cellValue": "hardware",
                    "linkTarget": "parameter",
                    "linkLabel": "Orphaned Disks",
                    "subTarget": "orphaneddisks",
                    "style": "link"
                  },
                  {
                    "id": "a45a3005-c5b6-46a7-8873-ac1e471c51b4",
                    "cellValue": "hardware",
                    "linkTarget": "parameter",
                    "linkLabel": "Orphaned NICs",
                    "subTarget": "orphanednics",
                    "style": "link"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "compute",
                "comparison": "isEqualTo",
                "value": "azure"
              },
              "name": "links - Azure Compute Storage Networking Breakdown"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| extend nics=array_length(properties.networkProfile.networkInterfaces)\r\n| mv-expand nic=properties.networkProfile.networkInterfaces\r\n| where nics == 1 or nic.properties.primary =~ 'true' or isempty(nic)\r\n| project vmId = id, vmName = name, vmSize=tostring(properties.hardwareProfile.vmSize), nicId = tostring(nic.id)\r\n\t| join kind=leftouter (\r\n \t\tResources\r\n  \t\t| where type =~ 'microsoft.network/networkinterfaces'\r\n  \t\t| extend ipConfigsCount=array_length(properties.ipConfigurations)\r\n  \t\t| mv-expand ipconfig=properties.ipConfigurations\r\n  \t\t| where ipConfigsCount == 1 or ipconfig.properties.primary =~ 'true'\r\n  \t\t| project nicId = id, privateIP= tostring(ipconfig.properties.privateIPAddress), publicIpId = tostring(ipconfig.properties.publicIPAddress.id), subscriptionId) on nicId\r\n| project-away nicId1\r\n| summarize by vmId, vmSize, nicId, privateIP, publicIpId, subscriptionId\r\n\t| join kind=leftouter (\r\n  \t\tResources\r\n  \t\t| where type =~ 'microsoft.network/publicipaddresses'\r\n  \t\t| project publicIpId = id, publicIpAddress = tostring(properties.ipAddress)) on publicIpId\r\n| project-away publicIpId1\r\n| sort by publicIpAddress desc",
                "size": 0,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "vmId",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    }
                  ],
                  "rowLimit": 1000,
                  "filter": true,
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "subscriptionId"
                    ],
                    "expandTopLevel": true,
                    "finalBy": "vmId"
                  }
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  "leftContent": {
                    "columnMatch": "Count",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto",
                      "showIcon": true
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "conditionalVisibilities": [
                {
                  "parameterName": "compute",
                  "comparison": "isEqualTo",
                  "value": "azure"
                },
                {
                  "parameterName": "hardware",
                  "comparison": "isEqualTo",
                  "value": "network"
                }
              ],
              "name": "query - Azure Compute Networking",
              "styleSettings": {
                "padding": "0 0 200px 0"
              }
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources | where type == \"microsoft.compute/virtualmachines\"\r\n| extend osDiskId= tostring(properties.storageProfile.osDisk.managedDisk.id)\r\n        | join kind=leftouter(resources\r\n            | where type =~ 'microsoft.compute/disks'\r\n            | where properties !has 'Unattached'\r\n            | where properties has 'osType'\r\n            | project OS = tostring(properties.osType), osSku = tostring(sku.name), osDiskSizeGB = toint(properties.diskSizeGB), osDiskId=tostring(id)) on osDiskId\r\n        | join kind=leftouter(Resources\r\n            | where type =~ 'microsoft.compute/disks'\r\n            | where properties !has \"osType\"\r\n            | where properties !has 'Unattached'\r\n            | project sku = tostring(sku.name), diskSizeGB = toint(properties.diskSizeGB), id = managedBy\r\n            | summarize sum(diskSizeGB), count(sku) by id, sku) on id\r\n| project vmId=id, OS, location, resourceGroup, subscriptionId, osDiskId, osSku, osDiskSizeGB, DataDisksGB=sum_diskSizeGB, diskSkuCount=count_sku\r\n| sort by diskSkuCount desc",
                "size": 1,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "vmId",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    }
                  ],
                  "rowLimit": 1000,
                  "filter": true,
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "subscriptionId"
                    ],
                    "expandTopLevel": true,
                    "finalBy": "vmId"
                  }
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  "leftContent": {
                    "columnMatch": "Count",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto",
                      "showIcon": true
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "conditionalVisibilities": [
                {
                  "parameterName": "compute",
                  "comparison": "isEqualTo",
                  "value": "azure"
                },
                {
                  "parameterName": "hardware",
                  "comparison": "isEqualTo",
                  "value": "storage"
                }
              ],
              "name": "query - Azure Compute Disks",
              "styleSettings": {
                "padding": "0 0 200px 0"
              }
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources  \r\n| where type contains \"microsoft.compute/disks\" \r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\"\r\n    or diskState == 'Unattached'\r\n| project id, diskState, resourceGroup, location, subscriptionId",
                "size": 2,
                "noDataMessage": "No oprhaned disks found",
                "noDataMessageStyle": 3,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "id",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    }
                  ],
                  "rowLimit": 1000,
                  "filter": true,
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "subscriptionId"
                    ],
                    "expandTopLevel": true,
                    "finalBy": "id"
                  }
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  "leftContent": {
                    "columnMatch": "Count",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto",
                      "showIcon": true
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "conditionalVisibilities": [
                {
                  "parameterName": "compute",
                  "comparison": "isEqualTo",
                  "value": "azure"
                },
                {
                  "parameterName": "hardware",
                  "comparison": "isEqualTo",
                  "value": "orphaneddisks"
                }
              ],
              "name": "query - Azure Compute - Orphaned Disks",
              "styleSettings": {
                "padding": "0 0 200px 0"
              }
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "resources\r\n| where type contains \"microsoft.network/networkinterfaces\"\r\n| where properties !has 'virtualmachine'\r\n| project id, resourceGroup, location, subscriptionId",
                "size": 2,
                "noDataMessage": "No orphaned nics found",
                "noDataMessageStyle": 3,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "id",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    }
                  ],
                  "rowLimit": 1000,
                  "filter": true,
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "subscriptionId"
                    ],
                    "expandTopLevel": true,
                    "finalBy": "id"
                  }
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  "leftContent": {
                    "columnMatch": "Count",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto",
                      "showIcon": true
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": true
                },
                "graphSettings": {
                  "type": 0,
                  "topContent": {
                    "columnMatch": "vmSize",
                    "formatter": 1
                  },
                  "centerContent": {
                    "columnMatch": "Count",
                    "formatter": 1,
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "conditionalVisibilities": [
                {
                  "parameterName": "compute",
                  "comparison": "isEqualTo",
                  "value": "azure"
                },
                {
                  "parameterName": "hardware",
                  "comparison": "isEqualTo",
                  "value": "orphanednics"
                }
              ],
              "name": "query - Azure Compute Orphaned NICs",
              "styleSettings": {
                "padding": "0 0 200px 0"
              }
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "compute"
        },
        "name": "group - Environment"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Health Overview Group",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "# Health Overview"
              },
              "name": "text - Title"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "{\"version\":\"AzureHealthQuery/1.0\",\"queryType\":\"Summary\"}",
                "size": 4,
                "queryType": 4,
                "resourceType": "microsoft.resources/subscriptions",
                "crossComponentResources": [
                  "{Subscriptions}"
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "HealthOverview"
              },
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "{\"version\":\"AzureHealthQuery/1.0\",\"queryType\":\"Detailed\"}",
                "size": 3,
                "queryType": 4,
                "resourceType": "microsoft.resources/subscriptions",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "Availability state",
                      "formatter": 11
                    },
                    {
                      "columnMatch": "Detailed status",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "Title",
                      "formatter": 5
                    }
                  ]
                }
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "HealthOverview"
              },
              "name": "query - 5"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "HealthOverview"
        },
        "name": "group - Overview"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Networking Details",
          "items": [
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "36241550-6bcc-48ce-9f10-373f11e61ca6",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "VPN Gateway",
                    "subTarget": "VPN",
                    "style": "link"
                  },
                  {
                    "id": "fe6921bf-36ad-4c23-b323-846dba7c00aa",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "vNET Peerings",
                    "subTarget": "vnetpeering",
                    "style": "link"
                  },
                  {
                    "id": "279a5357-79b7-4839-ae91-1f2c84ffefcd",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "NAT Gateway",
                    "subTarget": "NATGateway",
                    "style": "link"
                  },
                  {
                    "id": "5c167305-3eff-4612-a28a-8be527307914",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "NSG Firewall Rules",
                    "subTarget": "nsgrules",
                    "style": "link"
                  },
                  {
                    "id": "cf63345b-aa73-4ad2-babd-9ae1eaa5dae8",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Public IPs",
                    "subTarget": "PublicIPs",
                    "style": "link"
                  },
                  {
                    "id": "11426c5c-1edb-41a5-bb7f-fbfb8bbc4bba",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Unassociated NSGs",
                    "subTarget": "blanknsgs",
                    "style": "link"
                  },
                  {
                    "id": "d36b1b09-17de-4dd4-838d-7f3973a7efbf",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Unused PiPs",
                    "subTarget": "blankpip",
                    "style": "link"
                  }
                ]
              },
              "name": "links - Networking Details - Tabs",
              "styleSettings": {
                "showBorder": true
              }
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.network/virtualnetworkgateways\"\r\n| extend PublicIPType = properties['ipConfigurations'][0]['properties']['privateIPAllocationMethod']\r\n| extend PublicIP = properties['bgpSettings']['bgpPeeringAddresses'][0]['tunnelIpAddresses']\r\n| extend VPNGeneration = properties['ipConfigurations'][0]['properties']['vpnGatewayGeneration']\r\n| extend [\"vNet Sku\"]= properties['sku']['name']\r\n| project Customer=subscriptionId, [\"Gateway Name\"]=id, location, PublicIP, PublicIPType, SKUGeneration=properties.vpnGatewayGeneration, [\"vNet Sku\"], VPNType=properties.vpnType",
                      "size": 1,
                      "title": "vNET Gateway",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "PublicIP",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "PublicIPType",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "SKUGeneration",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "vNet Sku",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "VPNType",
                            "formatter": 1
                          }
                        ]
                      }
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "VPN"
                    },
                    "showPin": true,
                    "name": "query - 8"
                  },
                  {
                    "type": 1,
                    "content": {
                      "json": "## **To Confirm the Real Connection Status ---> Click on the Connection Name to go directly to the Azure Resource. Then Verify the status from the resource in the Azure portal - The Information below comes from the Azure Resource Graph and can be delayed up to 30 minutes** "
                    },
                    "name": "text - 2"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.network/connections\"\r\n| extend LocalNetwork=tostring(properties.localNetworkGateway2.id)\r\n| project Customer=subscriptionId, id, name, [\"Connection Status\"]=properties.connectionStatus, ConnectionType=properties.connectionType, ConnectionProtocol=properties.connectionProtocol, LocalNetwork, properties.sharedKey\r\n| join kind=leftouter (\r\n   resources\r\n| where type == \"microsoft.network/localnetworkgateways\"\r\n| extend LocalNetwork = tostring(id)\r\n| project LocalNetwork, subscriptionId, location, LocalIPs=properties.localNetworkAddressSpace.addressPrefixes[0], properties.gatewayIpAddress) on LocalNetwork\r\n| extend ['Shared Key']=properties_sharedKey\r\n| project Customer, [\"Connection Name\"]=id, [\"Connection Status\"], ConnectionType, ConnectionProtocol, [\"Local Network Gateway\"]=LocalNetwork, Location=location, [\"Customer's Local IP Ranges\"]=LocalIPs, ['Customers Local Public IP']=properties_gatewayIpAddress, ['Shared Key']\r\n",
                      "size": 2,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Connection Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "Connected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "ConnectionType",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "ConnectionProtocol",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Location",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Shared Key",
                            "formatter": 1
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "VPN"
                    },
                    "name": "query - 10"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "VPN"
              },
              "name": "group - VPN Group"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "vNet Peering Health",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.network/virtualnetworks\"\r\n| mvexpand [\"vNET Peering Name\"] = properties['virtualNetworkPeerings']\r\n| project Customer=subscriptionId, vNETPeeringName=tostring([\"vNET Peering Name\"].id), PeeringState=tostring([\"vNET Peering Name\"].properties.peeringState), AllowVirtualNetworkAccess=tostring([\"vNET Peering Name\"].properties.allowVirtualNetworkAccess), AllowForwadedTraffic=tostring([\"vNET Peering Name\"].properties.allowForwardedTraffic), DoNotVerifyRemoteGateways=tostring([\"vNET Peering Name\"].properties.doNotVerifyRemoteGateways), RemoteNetwork=tostring([\"vNET Peering Name\"].properties.remoteVirtualNetworkAddressSpace.addressPrefixes)\r\n| sort by Customer ",
                      "size": 2,
                      "title": "Showing Each Individual Peering",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "vNETPeeringName",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "60ch"
                            }
                          },
                          {
                            "columnMatch": "PeeringState",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "Connected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AllowVirtualNetworkAccess",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "true",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AllowForwadedTraffic",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "true",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "DoNotVerifyRemoteGateways",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "false",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "RemoteNetwork",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "50ch"
                            }
                          }
                        ],
                        "sortBy": [
                          {
                            "itemKey": "RemoteNetwork",
                            "sortOrder": 1
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "RemoteNetwork",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "name": "query - 0 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources \r\n| where type=~\"Microsoft.Network/virtualNetworks\" \r\n| extend [\"vNET Peering Name\"] = properties['virtualNetworkPeerings'][0]\r\n| extend [\"vNET Peering Name 2\"] = properties['virtualNetworkPeerings'][1]\r\n| extend [\"vNET Peering Name 3\"] = properties['virtualNetworkPeerings'][2]\r\n| project [\"vNET Peering Name\"], [\"vNET Peering Name 2\"], [\"vNET Peering Name 3\"]",
                      "size": 4,
                      "title": "Showing Additional Details About Specific Peerings",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "vNET Peering Name",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Peering Details",
                              "linkIsContextBlade": true,
                              "customColumnWidthSetting": "30ch"
                            }
                          },
                          {
                            "columnMatch": "vNET Peering Name 2",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Peering Details",
                              "linkIsContextBlade": true,
                              "customColumnWidthSetting": "30ch"
                            }
                          },
                          {
                            "columnMatch": "vNET Peering Name 3",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Peering Details",
                              "linkIsContextBlade": true,
                              "customColumnWidthSetting": "30ch"
                            }
                          }
                        ]
                      }
                    },
                    "name": "query - 1"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.network/virtualnetworks\"\r\n| extend Peering1=properties['virtualNetworkPeerings'][0]['properties']['peeringState']\r\n| extend Peering2=properties['virtualNetworkPeerings'][1]['properties']['peeringState']\r\n| extend Peering3=properties['virtualNetworkPeerings'][2]['properties']['peeringState']\r\n| extend Peering4=properties['virtualNetworkPeerings'][3]['properties']['peeringState']\r\n| extend Peering5=properties['virtualNetworkPeerings'][4]['properties']['peeringState']\r\n| extend Peering6=properties['virtualNetworkPeerings'][5]['properties']['peeringState']\r\n| project Customer=subscriptionId, vNetName=name, resourceGroup, location, Peering1, Peering2, Peering3, Peering4, Peering5, Peering6\r\n| sort by Customer ",
                      "size": 2,
                      "title": "Peerings In Each vNet",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Peering1",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "NotConnected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Connected",
                                  "representation": "green",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "gray",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Peering2",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "is Empty",
                                  "representation": "gray",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "NotConnected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Peering3",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "NotConnected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "is Empty",
                                  "representation": "gray",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Connected",
                                  "representation": "green"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Peering4",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "NotConnected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Connected",
                                  "representation": "green"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "gray",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Peering5",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "NotConnected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Connected",
                                  "representation": "green",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "gray",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Peering6",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "NotConnected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Connected",
                                  "representation": "green",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "gray",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "vNETPeeringName",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "60ch"
                            }
                          },
                          {
                            "columnMatch": "PeeringState",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "Connected",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AllowVirtualNetworkAccess",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "true",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AllowForwadedTraffic",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "true",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "DoNotVerifyRemoteGateways",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "false",
                                  "representation": "2",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "success",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "RemoteNetwork",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "50ch"
                            }
                          }
                        ]
                      }
                    },
                    "name": "query - 0 - Copy - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "vnetpeering"
              },
              "name": "group - 9"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "NAT Gateway",
                "items": [
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "parameters": [
                        {
                          "id": "e9078a0e-157e-4ead-9a5f-020fb0c6f7aa",
                          "version": "KqlParameterItem/1.0",
                          "name": "NATGateway",
                          "type": 5,
                          "isRequired": true,
                          "query": "resources\r\n| where type =~ \"Microsoft.Network/natGateways\"\r\n| project id, name",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::1"
                            ],
                            "showDefault": false
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "defaultValue": "value::1",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        {
                          "id": "018956b9-bf48-4274-a1b2-2ed4aee10487",
                          "version": "KqlParameterItem/1.0",
                          "name": "TimeRange",
                          "type": 4,
                          "isRequired": true,
                          "isGlobal": true,
                          "value": {
                            "durationMs": 172800000
                          },
                          "typeSettings": {
                            "selectableValues": [
                              {
                                "durationMs": 300000
                              },
                              {
                                "durationMs": 900000
                              },
                              {
                                "durationMs": 1800000
                              },
                              {
                                "durationMs": 3600000
                              },
                              {
                                "durationMs": 14400000
                              },
                              {
                                "durationMs": 43200000
                              },
                              {
                                "durationMs": 86400000
                              },
                              {
                                "durationMs": 172800000
                              },
                              {
                                "durationMs": 259200000
                              },
                              {
                                "durationMs": 604800000
                              },
                              {
                                "durationMs": 1209600000
                              },
                              {
                                "durationMs": 2419200000
                              },
                              {
                                "durationMs": 2592000000
                              },
                              {
                                "durationMs": 5184000000
                              },
                              {
                                "durationMs": 7776000000
                              }
                            ]
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          }
                        }
                      ],
                      "style": "pills",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    "name": "parameters - 7"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Resources\r\n| where type =~ 'microsoft.network/natgateways'\r\n| where id =~ '{NATGateway}'\r\n| extend NATprop = parse_json(properties), SKUprop = parse_json(sku)\r\n| extend vNET=split(properties.subnets,\"/\")[8]\r\n| extend Subnetraw=split(properties.subnets,\"/\")[10] | extend Subnet=split(Subnetraw,'\"')[0]\r\n| extend PublicIPID=split(properties.publicIpAddresses, '\"')[3]\r\n| project ['Nat Gateway Name'] = tostring(id), ['vNET Name']=vNET, ProvisionsingState = NATprop.provisioningState, Subnet, PublicIPiD=tostring(PublicIPID)\r\n\t| join kind=leftouter (\r\n  \t\tResources\r\n  \t\t| where type =~ 'microsoft.network/publicipaddresses'\r\n  \t\t| project PublicIPiD = id, publicIpAddress = tostring(properties.ipAddress)) on PublicIPiD\r\n| project-away PublicIPiD1, PublicIPiD\r\n",
                      "size": 4,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{NATGateway}"
                      ],
                      "sortBy": []
                    },
                    "customWidth": "70",
                    "name": "query - 8"
                  },
                  {
                    "type": 1,
                    "content": {
                      "json": "#### Useful Documentation\r\n* Confluence Documenation)\r\n* [Virtual NAT Overview](https://docs.microsoft.com/azure/virtual-network/nat-overview)\r\n* [NAT Gateway Resource](https://docs.microsoft.com/azure/virtual-network/nat-gateway-resource)\r\n* [NAT Gateway Metrics](https://docs.microsoft.com/azure/virtual-network/nat-metrics)\r\n* [Troubleshoot NAT Gateway connectivity](https://docs.microsoft.com/azure/virtual-network/troubleshoot-nat) \r\n\r\n\r\n\r\n"
                    },
                    "customWidth": "30",
                    "name": "text - 9"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbookc77d6518-bab6-406c-9f32-6cd0ed13a9d0",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 3,
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--ByteCount",
                          "aggregation": 1,
                          "splitBy": null,
                          "columnName": "Total Bytes Transmitted"
                        },
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--PacketCount",
                          "aggregation": 1,
                          "columnName": "Total Packets Transmitted"
                        }
                      ],
                      "title": "Outbound Bytes and Packets",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "showBorder": false,
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "mapSettings": {
                        "locInfo": "AzureResource",
                        "sizeSettings": "Value",
                        "sizeAggregation": "Sum",
                        "legendMetric": "Value",
                        "legendAggregation": "Sum",
                        "itemColorSettings": {
                          "type": "heatmap",
                          "colorAggregation": "Sum",
                          "nodeColorField": "Value",
                          "heatmapPalette": "greenRed"
                        },
                        "locInfoColumn": "Name"
                      },
                      "graphSettings": {
                        "type": 0,
                        "topContent": {
                          "columnMatch": "Subscription",
                          "formatter": 1
                        },
                        "centerContent": {
                          "columnMatch": "Value",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "showOpenInMe": true,
                      "filters": [
                        {
                          "id": "5",
                          "key": "Direction",
                          "operator": 0,
                          "values": [
                            "Out"
                          ]
                        }
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Subscription",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Name",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource"
                            }
                          },
                          {
                            "columnMatch": "Total Bytes Transmitted Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--ByteCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 2,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Total Packets Transmitted Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--PacketCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Metric",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Aggregation",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Value",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Timeline",
                            "formatter": 9
                          }
                        ],
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "50",
                    "name": "Outbound Bytes and Packets"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbookc77d6518-bab6-406c-9f32-6cd0ed13a9d0",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 3,
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--ByteCount",
                          "aggregation": 1,
                          "splitBy": null,
                          "columnName": "Total Bytes Transmitted"
                        },
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--PacketCount",
                          "aggregation": 1,
                          "columnName": "Total Packets Transmitted"
                        }
                      ],
                      "title": "Inbound Bytes and Packets",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "showBorder": false,
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "mapSettings": {
                        "locInfo": "AzureResource",
                        "sizeSettings": "Value",
                        "sizeAggregation": "Sum",
                        "legendMetric": "Value",
                        "legendAggregation": "Sum",
                        "itemColorSettings": {
                          "type": "heatmap",
                          "colorAggregation": "Sum",
                          "nodeColorField": "Value",
                          "heatmapPalette": "greenRed"
                        },
                        "locInfoColumn": "Name"
                      },
                      "graphSettings": {
                        "type": 0,
                        "topContent": {
                          "columnMatch": "Subscription",
                          "formatter": 1
                        },
                        "centerContent": {
                          "columnMatch": "Value",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "showOpenInMe": true,
                      "filters": [
                        {
                          "id": "1",
                          "key": "Direction",
                          "operator": 0,
                          "values": [
                            "In"
                          ]
                        }
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Subscription",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Name",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource"
                            }
                          },
                          {
                            "columnMatch": "Total Bytes Transmitted Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--ByteCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 2,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Total Packets Transmitted Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--PacketCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Metric",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Aggregation",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Value",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Timeline",
                            "formatter": 9
                          }
                        ],
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "50",
                    "name": "Inbound Bytes and Packets - Copy"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook0b8de185-5c7f-47fe-8fed-699fb211bf07",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 2,
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--DatapathAvailability",
                          "aggregation": 4,
                          "splitBy": null,
                          "columnName": "Average Datapath Availability"
                        }
                      ],
                      "title": "Datapath Availability",
                      "showOpenInMe": true,
                      "gridSettings": {
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "50",
                    "showPin": false,
                    "name": "Datapath Availability and Packets Dropped"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook0b8de185-5c7f-47fe-8fed-699fb211bf07",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 2,
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--PacketDropCount",
                          "aggregation": 1,
                          "splitBy": null,
                          "columnName": "Total Packets Dropped"
                        }
                      ],
                      "title": "Packets Dropped",
                      "showOpenInMe": true,
                      "gridSettings": {
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "50",
                    "name": "Packets Dropped "
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook69e6d92a-5667-4917-8bb1-690ce6b48fd3",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 2,
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--TotalConnectionCount",
                          "aggregation": 1,
                          "splitBy": null,
                          "columnName": "Total SNAT Connection Count"
                        }
                      ],
                      "title": "Total SNAT Connection Count",
                      "showOpenInMe": true,
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Subscription",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Name",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource"
                            }
                          },
                          {
                            "columnMatch": "SNAT Ports in Use Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--TotalConnectionCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Attempted Connects Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--SNATConnectionCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          }
                        ],
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "33.33",
                    "name": "Total SNAT Connection Count"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook69e6d92a-5667-4917-8bb1-690ce6b48fd3",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 1,
                      "color": "greenDark",
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--SNATConnectionCount",
                          "aggregation": 1,
                          "splitBy": null,
                          "columnName": "Attempted Connections"
                        }
                      ],
                      "title": "Attempted Connections",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "showBorder": false,
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "mapSettings": {
                        "locInfo": "AzureResource",
                        "sizeSettings": "Value",
                        "sizeAggregation": "Sum",
                        "legendMetric": "Value",
                        "legendAggregation": "Sum",
                        "itemColorSettings": {
                          "type": "heatmap",
                          "colorAggregation": "Sum",
                          "nodeColorField": "Value",
                          "heatmapPalette": "greenRed"
                        },
                        "locInfoColumn": "Name"
                      },
                      "graphSettings": {
                        "type": 0,
                        "topContent": {
                          "columnMatch": "Subscription",
                          "formatter": 1
                        },
                        "centerContent": {
                          "columnMatch": "Value",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "showOpenInMe": true,
                      "filters": [
                        {
                          "id": "2",
                          "key": "ConnectionState",
                          "operator": 0,
                          "values": [
                            "Attempted"
                          ]
                        }
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Subscription",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Name",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource"
                            }
                          },
                          {
                            "columnMatch": "SNAT Ports in Use Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--TotalConnectionCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Attempted Connects Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--SNATConnectionCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Failed Connections Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Attempted Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Metric",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Aggregation",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Value",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Timeline",
                            "formatter": 9
                          }
                        ],
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "33.33",
                    "name": "Attempted Connections"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook69e6d92a-5667-4917-8bb1-690ce6b48fd3",
                      "version": "MetricsItem/2.0",
                      "size": 0,
                      "chartType": 1,
                      "color": "red",
                      "resourceType": "microsoft.network/natgateways",
                      "metricScope": 0,
                      "resourceParameter": "NATGateway",
                      "resourceIds": [
                        "{NATGateway}"
                      ],
                      "timeContextFromParameter": "TimeRange",
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.network/natgateways",
                          "metric": "microsoft.network/natgateways--SNATConnectionCount",
                          "aggregation": 1,
                          "splitBy": null,
                          "columnName": "Failed Connections"
                        }
                      ],
                      "title": "Failed Connections",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "showBorder": false,
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "mapSettings": {
                        "locInfo": "AzureResource",
                        "sizeSettings": "Value",
                        "sizeAggregation": "Sum",
                        "legendMetric": "Value",
                        "legendAggregation": "Sum",
                        "itemColorSettings": {
                          "type": "heatmap",
                          "colorAggregation": "Sum",
                          "nodeColorField": "Value",
                          "heatmapPalette": "greenRed"
                        },
                        "locInfoColumn": "Name"
                      },
                      "graphSettings": {
                        "type": 0,
                        "topContent": {
                          "columnMatch": "Subscription",
                          "formatter": 1
                        },
                        "centerContent": {
                          "columnMatch": "Value",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "showOpenInMe": true,
                      "filters": [
                        {
                          "id": "1",
                          "key": "ConnectionState",
                          "operator": 0,
                          "values": [
                            "Failed"
                          ]
                        }
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Subscription",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Name",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource"
                            }
                          },
                          {
                            "columnMatch": "SNAT Ports in Use Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--TotalConnectionCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Attempted Connects Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "microsoft.network/natgateways--SNATConnectionCount",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": null
                            }
                          },
                          {
                            "columnMatch": "Failed Connections Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Attempted Timeline",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Metric",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Aggregation",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Value",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Timeline",
                            "formatter": 9
                          }
                        ],
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "33.33",
                    "name": "Failed Connections"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "NATGateway"
              },
              "name": "group - NATGateway"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Public IP List",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Resources\r\n| where type =~ 'Microsoft.Network/publicIPAddresses'\r\n| project id, name, subscriptionId, location, SKU=sku.name, SKURegion=sku.tier, PublicIP=properties.ipAddress, AllocationType=properties.publicIPAllocationMethod",
                      "size": 3,
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "vmId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 5
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "subscriptionId"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "vmId"
                        }
                      },
                      "tileSettings": {
                        "titleContent": {
                          "columnMatch": "vmSize",
                          "formatter": 1,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        "leftContent": {
                          "columnMatch": "Count",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto",
                            "showIcon": true
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        "showBorder": true
                      },
                      "graphSettings": {
                        "type": 0,
                        "topContent": {
                          "columnMatch": "vmSize",
                          "formatter": 1
                        },
                        "centerContent": {
                          "columnMatch": "Count",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      }
                    },
                    "name": "query - Azure Compute Networking - Copy",
                    "styleSettings": {
                      "padding": "0 0 200px 0"
                    }
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "PublicIPs"
              },
              "name": "group - 9 - Copy"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "NSG-Firewall-Policies",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Resources\r\n    | where type =~ 'microsoft.network/networksecuritygroups'\r\n    | project id, nsgRules = parse_json(parse_json(properties).securityRules), networksecurityGroupName = name, subscriptionId, resourceGroup , location\r\n    | mvexpand nsgRule = nsgRules\r\n    | project id, location, access=nsgRule.properties.access,protocol=nsgRule.properties.protocol ,direction=nsgRule.properties.direction,provisioningState= nsgRule.properties.provisioningState ,priority=nsgRule.properties.priority, \r\n        sourceAddressPrefix = nsgRule.properties.sourceAddressPrefix, \r\n        sourceAddressPrefixes = nsgRule.properties.sourceAddressPrefixes,\r\n        destinationAddressPrefix = nsgRule.properties.destinationAddressPrefix, \r\n        destinationAddressPrefixes = nsgRule.properties.destinationAddressPrefixes, \r\n        networksecurityGroupName, networksecurityRuleName = tostring(nsgRule.name), \r\n        subscriptionId, resourceGroup,\r\n        destinationPortRanges = nsgRule.properties.destinationPortRanges,\r\n        destinationPortRange = nsgRule.properties.destinationPortRange,\r\n        sourcePortRanges = nsgRule.properties.sourcePortRanges,\r\n        sourcePortRange = nsgRule.properties.sourcePortRange\r\n| extend Details = pack_all()\r\n| project id, location, access, direction, subscriptionId, resourceGroup, Details",
                      "size": 2,
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "id",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "resourceGroup",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "24.1429ch"
                            }
                          },
                          {
                            "columnMatch": "Details",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Details",
                              "linkIsContextBlade": true
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "subscriptionId"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "id"
                        }
                      },
                      "tileSettings": {
                        "titleContent": {
                          "columnMatch": "type",
                          "formatter": 1
                        },
                        "leftContent": {
                          "columnMatch": "count_",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        "showBorder": true,
                        "sortCriteriaField": "count_",
                        "sortOrderField": 2
                      }
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "nsgrules"
                    },
                    "name": "query - Networking Details - NSG Rules",
                    "styleSettings": {
                      "padding": "0 0 200px 0"
                    }
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "nsgrules"
              },
              "name": "group - NSG-Firewall-Policies"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources\r\n| where type =~ 'microsoft.network/networksecuritygroups' and isnull(properties.networkInterfaces) and isnull(properties.subnets)\r\n| project Resource=id, resourceGroup, subscriptionId, location",
                "size": 0,
                "noDataMessage": "No Unassociated NSGs Found",
                "noDataMessageStyle": 3,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "Resource",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "id",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "Details",
                      "formatter": 7,
                      "formatOptions": {
                        "linkTarget": "CellDetails",
                        "linkLabel": " View Details",
                        "linkIsContextBlade": true
                      }
                    }
                  ],
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "subscriptionId"
                    ],
                    "expandTopLevel": true,
                    "finalBy": "Resource"
                  }
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "type",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": true,
                  "sortCriteriaField": "count_",
                  "sortOrderField": 2
                }
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "blanknsgs"
              },
              "name": "query - Networking Details - Unassociated NSGs",
              "styleSettings": {
                "padding": "0 0 100px 0"
              }
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Resources\r\n| where type =~ 'Microsoft.Network/publicIPAddresses' and isnull(properties.ipAddress)\r\n| extend ipAddress = properties.ipAddress\r\n| extend sku = sku.name\r\n| extend Details = pack_all()\r\n| project Resource=id, subscriptionId, resourceGroup, name, location,sku,Details",
                "size": 0,
                "showExportToExcel": true,
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "visualization": "table",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "$gen_group",
                      "formatter": 13,
                      "formatOptions": {
                        "linkTarget": "Resource",
                        "linkIsContextBlade": true,
                        "showIcon": true
                      }
                    },
                    {
                      "columnMatch": "Resource",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "subscriptionId",
                      "formatter": 5
                    },
                    {
                      "columnMatch": "Details",
                      "formatter": 7,
                      "formatOptions": {
                        "linkTarget": "CellDetails",
                        "linkLabel": " View Details",
                        "linkIsContextBlade": true
                      }
                    }
                  ],
                  "filter": true,
                  "hierarchySettings": {
                    "treeType": 1,
                    "groupBy": [
                      "subscriptionId"
                    ],
                    "expandTopLevel": true,
                    "finalBy": "Resource"
                  }
                }
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "blankpip"
              },
              "name": "query - Networking Details - Unused PiPs"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "network"
        },
        "name": "group - Networking"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Backup Reports",
          "items": [
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "f22783d8-3b60-4290-93e7-c46653dc6040",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Backups Overview",
                    "subTarget": "BackupsOverview",
                    "style": "link"
                  },
                  {
                    "id": "aea6ee32-d08a-4127-a743-1bc39839e123",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Virtual Machines",
                    "subTarget": "BackupVirtualMachines",
                    "style": "link"
                  },
                  {
                    "id": "78be5394-539b-4b6c-a0fc-069c2d55f97e",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Azure Files",
                    "subTarget": "BackupAzureFiles",
                    "style": "link"
                  },
                  {
                    "id": "d40a3289-864a-4254-9b3d-f8ff2412951f",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Azure Netapp Files",
                    "subTarget": "BackupAzureNetappFiles",
                    "style": "link"
                  },
                  {
                    "id": "e8b435f8-a67a-42ce-9088-07ef99b232ce",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Azure Cosmos DB",
                    "subTarget": "BackupCosmosDB",
                    "style": "link"
                  },
                  {
                    "id": "29b78762-aa9a-4152-85d4-00ccbf596c03",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "All Resources",
                    "subTarget": "BackupResources",
                    "style": "link"
                  },
                  {
                    "id": "501d9123-0aed-450d-a321-b128c633cb21",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Size and Cost - VMs Only",
                    "subTarget": "SizeandCost",
                    "style": "link"
                  }
                ]
              },
              "name": "links - 6",
              "styleSettings": {
                "showBorder": true
              }
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "### **This page shows existing resouces in the customer environment. Use the tabs above in this page to verify important resources have backups.**"
                    },
                    "name": "text - 4"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.recoveryservices/vaults\"\r\n| project [\"Recover Service Vault\"] = id, location, resourceGroup, Customer=subscriptionId",
                      "size": 1,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Customer",
                            "formatter": 5,
                            "formatOptions": {
                              "linkTarget": "Resource"
                            }
                          },
                          {
                            "columnMatch": "Redundancy",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "GeoRedundant",
                                  "representation": "green",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ],
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "Customer"
                          ],
                          "expandTopLevel": true
                        }
                      },
                      "tileSettings": {
                        "showBorder": false
                      }
                    },
                    "name": "query - 5"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| project vmName = id, Status=properties.extended.instanceView.powerState.displayStatus",
                      "size": 3,
                      "title": "Active Virtual Machines",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "VM running",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    "customWidth": "25",
                    "name": "query - 1"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.storage/storageaccounts\"\r\n| project [\"Azure Files Account\"] = id",
                      "size": 3,
                      "title": "Azure File Shares",
                      "noDataMessage": "No Azure File Shares Detected",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ]
                    },
                    "customWidth": "25",
                    "name": "Azure File Shares"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type =~ 'Microsoft.NetApp/netAppAccounts/capacityPools/volumes'\r\n| project [\"ANF Volume\"] = id ",
                      "size": 3,
                      "title": "Azure NetApp Files",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "id",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "40ch"
                            }
                          }
                        ],
                        "sortBy": [
                          {
                            "itemKey": "$gen_link_ANF Volume_0",
                            "sortOrder": 1
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "$gen_link_ANF Volume_0",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "customWidth": "25",
                    "name": "Azure NetApp Files"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| extend Status = tostring(properties.status)\r\n//| where Status != \"Completed\"\r\n| extend NameOfResource = tostring(properties.entityFriendlyName)\r\n| extend ErrorInfo = properties['errorDetails'][0]['errorString']\r\n| extend Recommendation = properties['errorDetails'][0]['recommendations']\r\n| summarize count() by Status, NameOfResource\r\n| project Status, NameOfResource, RecentBackups=count_",
                      "size": 3,
                      "title": "Recent Backup Counts Per Resouce",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Failed",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    "customWidth": "25",
                    "name": "query - 0 - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupResources"
              },
              "name": "Backup-Overview"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "parameters": [
                        {
                          "id": "859639f0-b090-4520-a3b6-58bcb76b1b13",
                          "version": "KqlParameterItem/1.0",
                          "name": "AzureFilesAccount",
                          "type": 6,
                          "multiSelect": true,
                          "quote": "'",
                          "delimiter": ",",
                          "query": "resources\r\n| where type =~ \"microsoft.storage/storageaccounts\"\r\n| project id",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "isHiddenWhenLocked": true,
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::all"
                            ]
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "defaultValue": "value::all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        }
                      ],
                      "style": "pills",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    "name": "parameters - 1"
                  },
                  {
                    "type": 11,
                    "content": {
                      "version": "LinkItem/1.0",
                      "style": "tabs",
                      "links": [
                        {
                          "id": "d43a254e-53be-4e16-b16c-490a7f46c932",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "AZ Files Backup Policy Health",
                          "subTarget": "BackupPolicyHealth",
                          "preText": "",
                          "style": "link"
                        },
                        {
                          "id": "4483f6ad-7f7f-4ec7-96d7-00adb32b93d5",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "AZ Files Backups Enabled Checker",
                          "subTarget": "BackupsEnabledChecker",
                          "style": "link"
                        }
                      ]
                    },
                    "name": "links - 3",
                    "styleSettings": {
                      "showBorder": true
                    }
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Azure Files - Backup Policies",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where name contains \"AzureFileShare\"\r\n| extend LastBackupStatus = tostring(properties.lastBackupStatus)\r\n| mv-expand todynamic(properties.sourceResourceId) to typeof(dynamic)\r\n| extend SplitAll=split(properties.sourceResourceId, '/')\r\n| extend AzureStorageAccount =SplitAll[8]\r\n| project AzureStorageAccount, Customer=subscriptionId, RecoveryVault=id, FileShare=properties.friendlyName, LastBackupStatus, properties.protectionState, properties.protectionStatus, properties.lastBackupTime",
                            "size": 3,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 0,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "30ch"
                                  }
                                },
                                {
                                  "columnMatch": "AzureStorageAccount",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Customer",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "FileShare",
                                  "formatter": 1
                                },
                                {
                                  "columnMatch": "LastBackupStatus",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Completed",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "properties_protectionState",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Protected",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "properties_protectionStatus",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Healthy",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "properties_lastRecoveryPoint",
                                  "formatter": 6
                                },
                                {
                                  "columnMatch": "properties_lastBackupTime",
                                  "formatter": 6
                                },
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 0,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "30ch"
                                  }
                                },
                                {
                                  "columnMatch": "properties_friendlyName",
                                  "formatter": 1
                                }
                              ],
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "AzureStorageAccount"
                                ],
                                "expandTopLevel": true
                              },
                              "labelSettings": [
                                {
                                  "columnId": "LastBackupStatus",
                                  "comment": "Status of Last Backup Attempt"
                                }
                              ]
                            },
                            "sortBy": []
                          },
                          "name": "query - 2"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "BackupPolicyHealth"
                    },
                    "name": "group - Azure Files - Backup Policies"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Azure Files Backup Checker",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "resources\r\n| where type =~ \"microsoft.storage/storageaccounts\"\r\n| project Customer=subscriptionId, StorageAccount=id",
                            "size": 2,
                            "exportFieldName": "StorageAccount",
                            "exportParameterName": "SelectedStorageAccount",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true,
                                    "customColumnWidthSetting": "50ch"
                                  }
                                },
                                {
                                  "columnMatch": "Customer",
                                  "formatter": 5,
                                  "formatOptions": {
                                    "linkTarget": "Resource"
                                  }
                                }
                              ],
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "Customer"
                                ],
                                "expandTopLevel": true
                              }
                            }
                          },
                          "customWidth": "35",
                          "name": "query - 0"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GETARRAY\",\"path\":\"/{SelectedStorageAccount}/fileServices/default/shares?api-version=2022-05-01\",\"urlParams\":[],\"batchDisabled\":false,\"transformers\":null}",
                            "size": 0,
                            "noDataMessage": "Select Storage Account To View Details",
                            "exportFieldName": "id",
                            "exportParameterName": "FileShareSelected",
                            "exportDefaultValue": "[0]",
                            "queryType": 12,
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "name",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "type",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "etag",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "properties",
                                  "formatter": 5
                                }
                              ]
                            }
                          },
                          "customWidth": "25",
                          "name": "query - 1"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GETARRAY\",\"path\":\"/{FileShareSelected}?api-version=2022-05-01&$expand=stats\",\"urlParams\":[],\"batchDisabled\":true,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"columns\":[{\"path\":\"$.name\",\"columnid\":\"FileShareName\"},{\"path\":\"$.properties.metadata.AzureBackupProtected\",\"columnid\":\"BackupsProtected\"},{\"path\":\"$.properties.shareQuota\",\"columnid\":\"ShareQuota\"},{\"path\":\"$.properties.shareUsageBytes\",\"columnid\":\"ShareUsage\"}]}}]}",
                            "size": 0,
                            "noDataMessage": "Select Storage Account To View Details",
                            "queryType": 12,
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "BackupsProtected",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "==",
                                        "thresholdValue": "true",
                                        "representation": "green",
                                        "text": "YES"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "redBright",
                                        "text": "No"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "ShareQuota",
                                  "formatter": 0,
                                  "numberFormat": {
                                    "unit": 5,
                                    "options": {
                                      "style": "decimal"
                                    }
                                  }
                                },
                                {
                                  "columnMatch": "ShareUsage",
                                  "formatter": 0,
                                  "numberFormat": {
                                    "unit": 2,
                                    "options": {
                                      "style": "decimal"
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "customWidth": "40",
                          "name": "query - 2"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "BackupsEnabledChecker"
                    },
                    "name": "group - Azure Files Backup Checker"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupAzureFiles"
              },
              "name": "Backup-AzureFiles"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 11,
                    "content": {
                      "version": "LinkItem/1.0",
                      "style": "tabs",
                      "links": [
                        {
                          "id": "c5e24a75-09fb-4957-8fcd-952b8a0af5ae",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "VMs With Backup Policy",
                          "subTarget": "VMsWithBackupPolicy",
                          "style": "link"
                        },
                        {
                          "id": "3300cf6f-ab9c-4270-9ea5-202250c55bb9",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Non-Session Host VMs",
                          "subTarget": "NonSessionHostVMs",
                          "style": "link"
                        },
                        {
                          "id": "41591f54-6897-47db-beb1-10f07eaa1c14",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Session Host VMs",
                          "subTarget": "SessionHostVMs",
                          "style": "link"
                        }
                      ]
                    },
                    "name": "links - 7",
                    "styleSettings": {
                      "showBorder": true
                    }
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "VMs with Attached Backup Policy",
                      "items": [
                        {
                          "type": 1,
                          "content": {
                            "json": "#### This tab only Shows Virtual Machines with a backup policy currently applied and the health of the backup. Use the other tabs to determine if important virtual machines are missing backups."
                          },
                          "name": "text - 4"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems\"\r\n| where name contains \"VM\"\r\n//| mv-expand todynamic(properties.lastRecoveryPoint) to typeof(dynamic)\r\n//| extend SplitAll=split(properties.lastRecoveryPoint, 'T')\r\n//| extend [\"Last Restore Point\"] = SplitAll[0]\r\n| extend Pack=pack_all()\r\n| project Customer=subscriptionId, RecoveryServiceVault=id, VirtualMachine=properties.friendlyName, ProectionState=properties.protectionState, ProtectionStatus=properties.protectionStatus, CurrentProtectionState=properties.currentProtectionState, LastBackupStatus=properties.lastBackupStatus, [\"Last Restore Point\"]=properties.lastRecoveryPoint, [\"Details\"]=Pack\r\n",
                            "size": 3,
                            "title": "Virtual Machines Detected in Recovery Service Vault",
                            "noDataMessage": "No Virtual Machines Detected in the Recovery Service Vault",
                            "noDataMessageStyle": 4,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Customer",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "VirtualMachine",
                                  "formatter": 1
                                },
                                {
                                  "columnMatch": "ProectionState",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "==",
                                        "thresholdValue": "IRPending",
                                        "representation": "yellow",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Protected",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "ProtectionStatus",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Healthy",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "CurrentProtectionState",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "ProtectionConfigured",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "LastBackupStatus",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Completed",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "Last Restore Point",
                                  "formatter": 6
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "Customer"
                                ],
                                "expandTopLevel": true
                              }
                            }
                          },
                          "name": "query - 3"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "VMsWithBackupPolicy"
                    },
                    "name": "VM-Backups-BackupPolicy"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "All Non-Session Host VMs ",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend source = trim(' ', tolower(tostring(properties.resourceDetails.Source)))\r\n| extend resourceId = trim(' ', tolower(tostring(case(\r\n    source =~ \"azure\", properties.resourceDetails.Id,\r\n    extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,id)\r\n    ))))\r\n| extend status = trim(\" \", tostring(properties.status.code))\r\n| extend AssessmentName = tostring(properties.displayName)\r\n| where resourceId !contains \"vm-\"\r\n| where resourceId !contains \"pvd\"\r\n| where AssessmentName =~ \"Azure Backup should be enabled for virtual machines\" \r\n| extend Pack=pack_all()\r\n| project resourceId, status, AssessmentName, subscriptionId, [\"Details\"]=Pack\r\n| sort by AssessmentName\r\n",
                            "size": 4,
                            "title": "Virtual Machines Configured For Backups",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "status",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "==",
                                        "thresholdValue": "Unhealthy",
                                        "representation": "redBright",
                                        "text": "Not Configured"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "Configured"
                                      }
                                    ]
                                  }
                                }
                              ]
                            }
                          },
                          "customWidth": "50",
                          "conditionalVisibility": {
                            "parameterName": "Hidden",
                            "comparison": "isEqualTo",
                            "value": "YES"
                          },
                          "name": "query - 4"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where id !contains \"vm-\"\r\n| where id !contains \"pvd\"\r\n| project resourceId = id, VMStatus=properties.extended.instanceView.powerState.displayStatus\r\n",
                            "size": 4,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "Hidden",
                            "comparison": "isEqualTo",
                            "value": "Yes"
                          },
                          "name": "query - 1"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - 4\",\"rightTable\":\"query - 1\",\"leftColumn\":\"resourceId\",\"rightColumn\":\"resourceId\"}],\"projectRename\":[{\"originalName\":\"[query - 4].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 4].resourceId\",\"mergedName\":\"resourceId\",\"fromId\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\"},{\"originalName\":\"[query - 1].VMStatus\",\"mergedName\":\"VMStatus\",\"fromId\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\"},{\"originalName\":\"[query - 4].status\",\"mergedName\":\"status\",\"fromId\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\"},{\"originalName\":\"[query - 4].AssessmentName\",\"mergedName\":\"AssessmentName\",\"fromId\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\"},{\"originalName\":\"[query - 4].properties\",\"mergedName\":\"properties\",\"fromId\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\"},{\"originalName\":\"[query - 1].resourceId\",\"mergedName\":\"resourceId1\",\"fromId\":\"174381d1-6a74-42ce-80ff-ed8ee6564166\"},{\"originalName\":\"[query - 4].Details\",\"mergedName\":\"Details\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 4].id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 4].SessionHostName\",\"mergedName\":\"SessionHostName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 4].Status\",\"mergedName\":\"Status\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 4].HostPool\",\"mergedName\":\"HostPool\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 1].Customer\",\"mergedName\":\"Customer\",\"fromId\":\"unknown\"}]}",
                            "size": 3,
                            "title": "Non-Session Host Virtual Machines with Backups",
                            "queryType": 7,
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "VMStatus",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "icons",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "VM running",
                                        "representation": "2",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "success",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  },
                                  "tooltipFormat": {
                                    "tooltip": "This Column shows if the Virtual Machine is Running and Active"
                                  }
                                },
                                {
                                  "columnMatch": "status",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Healthy",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "AssessmentName",
                                  "formatter": 0,
                                  "tooltipFormat": {
                                    "tooltip": "Assessment Policy That is Queried to display results"
                                  }
                                },
                                {
                                  "columnMatch": "resourceId1",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true
                              },
                              "labelSettings": [
                                {
                                  "columnId": "resourceId",
                                  "label": "VM Name"
                                },
                                {
                                  "columnId": "status",
                                  "label": "Backup Status"
                                }
                              ]
                            }
                          },
                          "showPin": false,
                          "name": "query - 2"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "NonSessionHostVMs"
                    },
                    "name": "VM-Backups-Non-SessionHosts"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "All Session Host VMs ",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend source = trim(' ', tolower(tostring(properties.resourceDetails.Source)))\r\n| extend resourceId = trim(' ', tolower(tostring(case(\r\n    source =~ \"azure\", properties.resourceDetails.Id,\r\n    extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,id)\r\n    ))))\r\n| extend status = trim(\" \", tostring(properties.status.code))\r\n| extend AssessmentName = tostring(properties.displayName)\r\n| where AssessmentName =~ \"Azure Backup should be enabled for virtual machines\" \r\n| extend Pack=pack_all()\r\n| project resourceId, status, AssessmentName, [\"Details\"]=Pack\r\n| sort by AssessmentName\r\n",
                            "size": 0,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "Hidden",
                            "comparison": "isEqualTo",
                            "value": "YES"
                          },
                          "name": "query - Assessment"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "desktopvirtualizationresources\r\n| where type == \"microsoft.desktopvirtualization/hostpools/sessionhosts\"\r\n| extend SplitAll=split(name,'/')\r\n| extend HostPool = SplitAll[0]\r\n| extend SessionHostName = tostring(SplitAll[1])\r\n| project id, SessionHostName, StatusInHostPool=properties.status, HostPool, resourceId=properties.resourceId, Customer=subscriptionId",
                            "size": 0,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "Hidden",
                            "comparison": "isEqualTo",
                            "value": "Yes"
                          },
                          "name": "query - HostPool"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - Assessment\",\"rightTable\":\"query - HostPool\",\"leftColumn\":\"resourceId\",\"rightColumn\":\"resourceId\"}],\"projectRename\":[{\"originalName\":\"[query - Assessment].resourceId\",\"mergedName\":\"resourceId\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - HostPool].StatusInHostPool\",\"mergedName\":\"StatusInHostPool\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - Assessment].status\",\"mergedName\":\"status\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - Assessment].AssessmentName\",\"mergedName\":\"AssessmentName\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - Assessment].Details\",\"mergedName\":\"Details\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - HostPool].id\",\"mergedName\":\"id\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - HostPool].SessionHostName\",\"mergedName\":\"SessionHostName\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - HostPool].HostPool\",\"mergedName\":\"HostPool\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - HostPool].resourceId\",\"mergedName\":\"resourceId1\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"},{\"originalName\":\"[query - HostPool].Customer\",\"mergedName\":\"Customer\",\"fromId\":\"5fe1a7e5-8f67-420e-bd42-45f14738b0ab\"}]}",
                            "size": 3,
                            "title": "AVD Host Pools and Virtual Machine Backup Enabled",
                            "queryType": 7,
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": false
                                  },
                                  "tooltipFormat": {
                                    "tooltip": "Host Pool Name Used For Grouping"
                                  }
                                },
                                {
                                  "columnMatch": "StatusInHostPool",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "icons",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Available",
                                        "representation": "2",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "success",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "status",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "Healthy",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "SessionHostName",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "HostPool",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "resourceId1",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Customer",
                                  "formatter": 5,
                                  "formatOptions": {
                                    "linkTarget": "Resource"
                                  }
                                }
                              ],
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "Customer"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "HostPool"
                              },
                              "labelSettings": [
                                {
                                  "columnId": "resourceId",
                                  "label": "VM Name"
                                },
                                {
                                  "columnId": "status",
                                  "label": "Backup Status"
                                }
                              ]
                            }
                          },
                          "showPin": false,
                          "name": "query - 6"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "SessionHostVMs"
                    },
                    "name": "VM-Backups-SessionHostVMs"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupVirtualMachines"
              },
              "name": "Backup-VirtualMachines"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Backup-NetAppFiles",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "where type =~ 'Microsoft.NetApp/netAppAccounts/capacityPools/volumes'\r\n| extend Mountpoint = properties['mountTargets'][0]['smbServerFQDN']\r\n| project Customer=subscriptionId, id, Mountpoint=strcat(@\"\\\\\", Mountpoint, @\"\\\", properties.creationToken), Tier = properties.serviceLevel, PrivateIP = properties['mountTargets'][0]['ipAddress']",
                      "size": 1,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "id",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "60ch"
                            }
                          },
                          {
                            "columnMatch": "Mountpoint",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "70ch"
                            }
                          }
                        ]
                      }
                    },
                    "name": "query - 0"
                  },
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "parameters": [
                        {
                          "id": "c3032583-f6ab-411a-826c-2fbaaddbf1ba",
                          "version": "KqlParameterItem/1.0",
                          "name": "AzureNetAppFiles",
                          "type": 5,
                          "isRequired": true,
                          "multiSelect": true,
                          "quote": "'",
                          "delimiter": ",",
                          "query": "where type =~ 'Microsoft.NetApp/netAppAccounts/capacityPools/volumes'\r\n| project id",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "isHiddenWhenLocked": true,
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::all"
                            ]
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "defaultValue": "value::all",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        }
                      ],
                      "style": "pills",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    "name": "parameters - 2"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook315ca5aa-e56c-47ed-b5c7-b82158b439bd",
                      "version": "MetricsItem/2.0",
                      "size": 3,
                      "chartType": -1,
                      "resourceType": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                      "metricScope": 0,
                      "resourceParameter": "AzureNetAppFiles",
                      "resourceIds": [
                        "{AzureNetAppFiles}"
                      ],
                      "timeContext": {
                        "durationMs": 172800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                          "metric": "microsoft.netapp/netappaccounts/capacitypools/volumes--CbsVolumeProtected",
                          "aggregation": 4
                        }
                      ],
                      "title": "ANF Backups Enabled",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2,
                              "maximumSignificantDigits": 3
                            }
                          }
                        },
                        "showBorder": false
                      },
                      "gridSettings": {
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "15",
                    "name": "metric - 1"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook315ca5aa-e56c-47ed-b5c7-b82158b439bd",
                      "version": "MetricsItem/2.0",
                      "size": 3,
                      "chartType": -1,
                      "resourceType": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                      "metricScope": 0,
                      "resourceParameter": "AzureNetAppFiles",
                      "resourceIds": [
                        "{AzureNetAppFiles}"
                      ],
                      "timeContext": {
                        "durationMs": 604800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                          "metric": "microsoft.netapp/netappaccounts/capacitypools/volumes--CbsVolumeOperationComplete",
                          "aggregation": 4
                        }
                      ],
                      "title": "ANF Backups Completed",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2,
                              "maximumSignificantDigits": 3
                            }
                          }
                        },
                        "showBorder": false
                      },
                      "gridSettings": {
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "15",
                    "name": "metric - 1 - Copy"
                  },
                  {
                    "type": 10,
                    "content": {
                      "chartId": "workbook315ca5aa-e56c-47ed-b5c7-b82158b439bd",
                      "version": "MetricsItem/2.0",
                      "size": 3,
                      "chartType": -1,
                      "resourceType": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                      "metricScope": 0,
                      "resourceParameter": "AzureNetAppFiles",
                      "resourceIds": [
                        "{AzureNetAppFiles}"
                      ],
                      "timeContext": {
                        "durationMs": 604800000
                      },
                      "metrics": [
                        {
                          "namespace": "microsoft.netapp/netappaccounts/capacitypools/volumes",
                          "metric": "microsoft.netapp/netappaccounts/capacitypools/volumes--VolumeSnapshotSize",
                          "aggregation": 4
                        }
                      ],
                      "title": "ANF Snapshot Size GB",
                      "gridFormatType": 1,
                      "tileSettings": {
                        "titleContent": {
                          "columnMatch": "Name",
                          "formatter": 13,
                          "formatOptions": {
                            "showIcon": true
                          }
                        },
                        "leftContent": {
                          "columnMatch": "Value",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2,
                              "maximumSignificantDigits": 3
                            }
                          }
                        },
                        "showBorder": false
                      },
                      "gridSettings": {
                        "rowLimit": 10000
                      }
                    },
                    "customWidth": "15",
                    "name": "metric - 1 - Copy - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupAzureNetappFiles"
              },
              "name": "Backup-NetAppFiles"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Backup-CosmosDB",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type =~ \"Microsoft.DocumentDB/databaseAccounts\"\r\n| extend BackupType=properties.backupPolicy.type\r\n| extend [\"Backup Retention Interval in Hours\"] = properties['backupPolicy']['periodicModeProperties']['backupRetentionIntervalInHours']\r\n| extend [\"Backup Storage Redundancy\"] = properties['backupPolicy']['periodicModeProperties']['backupStorageRedundancy']\r\n| extend [\"Backup Interval In Minutes\"] = properties['backupPolicy']['periodicModeProperties']['backupIntervalInMinutes']\r\n| project Customer=subscriptionId, [\"Cosmos DB Name\"]=id, BackupType, [\"Backup Retention Interval in Hours\"], [\"Backup Storage Redundancy\"], [\"Backup Interval In Minutes\"]",
                      "size": 3,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "BackupType",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "Periodic",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Backup Retention Interval in Hours",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 26,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "Backup Storage Redundancy",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "Geo",
                                  "representation": "orange",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blue",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "Backup Interval In Minutes",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 25,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "name": "query - 0"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupCosmosDB"
              },
              "name": "Backup-CosmosDB"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Virtual Machine - Backups Size and Cost",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "AddonAzureBackupStorage\r\n| where StorageType != \"Cloud\"\r\n| summarize TotalBackupStorage_InGBs = avg(StorageConsumedInMBs)/1024 by Type\r\n| project Type, TotalBackupStorage_InGBs, DollarCost=(TotalBackupStorage_InGBs)*0.040\r\n\r\n",
                      "size": 4,
                      "title": "7 Day Cost Estimate for VMs Only",
                      "timeContext": {
                        "durationMs": 604800000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "TotalBackupStorage_InGBs",
                            "formatter": 8,
                            "formatOptions": {
                              "max": 20000,
                              "palette": "redBright"
                            },
                            "numberFormat": {
                              "unit": 5,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "DollarCost",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": {
                                "currency": "USD",
                                "style": "currency"
                              }
                            }
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "name": "query - 5"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "AddonAzureBackupStorage\r\n| where StorageType != \"Cloud\"\r\n| extend SplitAll=split(BackupItemUniqueId, ';')\r\n| extend ResourceName=tostring(SplitAll[4])\r\n| summarize TotalBackupStorage_InGBs = avg(StorageConsumedInMBs)/1024 by ResourceName\r\n| project ResourceName, TotalBackupStorage_InGBs, DollarCost=(TotalBackupStorage_InGBs)*0.040\r\n| sort by TotalBackupStorage_InGBs\r\n\r\n",
                      "size": 2,
                      "title": "7 Day - Virtual Machine Backup Storage and Cost - **ONLY SHOWS VMs**",
                      "timeContext": {
                        "durationMs": 604800000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "TotalBackupStorage_InGBs",
                            "formatter": 8,
                            "formatOptions": {
                              "max": 2000,
                              "palette": "red"
                            },
                            "numberFormat": {
                              "unit": 5,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          },
                          {
                            "columnMatch": "DollarCost",
                            "formatter": 1,
                            "numberFormat": {
                              "unit": 0,
                              "options": {
                                "currency": "USD",
                                "style": "currency"
                              }
                            }
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "name": "query - 5 - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "SizeandCost"
              },
              "name": "group - SizeAndCost"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Backup Job Details",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| extend Status = tostring(properties.status)\r\n| where Status != \"Completed\"\r\n| extend NameOfResource = tostring(properties.entityFriendlyName)\r\n| extend ErrorInfo = properties['errorDetails'][0]['errorString']\r\n| extend Recommendation = properties['errorDetails'][0]['recommendations']\r\n| project Customer=subscriptionId, id, NameOfResource, properties.storageAccountName, Status, ErrorInfo, Recommendation",
                      "size": 0,
                      "title": "Failed Backup Status and Recommendation",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "properties_storageAccountName",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Failed",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "ErrorInfo",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "70ch"
                            }
                          },
                          {
                            "columnMatch": "Recommendation",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "120ch"
                            }
                          }
                        ],
                        "filter": true
                      }
                    },
                    "name": "query - 0 - Copy - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| extend Status = tostring(properties.status)\r\n| where Status != \"Completed\"\r\n| extend NameOfResource = tostring(properties.entityFriendlyName)\r\n| extend ErrorInfo = properties['errorDetails'][0]['errorString']\r\n| extend Recommendation = properties['errorDetails'][0]['recommendations']\r\n| summarize count() by Status, NameOfResource",
                      "size": 3,
                      "title": "Not Complete Backup Status",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Failed",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ]
                      },
                      "tileSettings": {
                        "showBorder": false,
                        "titleContent": {
                          "columnMatch": "Status",
                          "formatter": 1
                        },
                        "leftContent": {
                          "columnMatch": "count_",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "graphSettings": {
                        "type": 0,
                        "topContent": {
                          "columnMatch": "Status",
                          "formatter": 1
                        },
                        "centerContent": {
                          "columnMatch": "count_",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      }
                    },
                    "customWidth": "25",
                    "name": "query - 0 - Copy - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| extend Status = tostring(properties.status)\r\n//| where Status != \"Completed\"\r\n| extend NameOfResource = tostring(properties.entityFriendlyName)\r\n| extend ErrorInfo = properties['errorDetails'][0]['errorString']\r\n| extend Recommendation = properties['errorDetails'][0]['recommendations']\r\n| summarize count() by Status, NameOfResource, subscriptionId\r\n| project Status, NameOfResource, RecentBackups=count_, subscriptionId\r\n| sort by Status desc",
                      "size": 2,
                      "title": "Recent Backup Counts Per Resouce",
                      "exportFieldName": "NameOfResource",
                      "exportParameterName": "NameParam",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Failed",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true
                      }
                    },
                    "customWidth": "35",
                    "name": "query - 0 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "recoveryservicesresources\r\n| where type == \"microsoft.recoveryservices/vaults/backupjobs\"\r\n| extend Status = tostring(properties.status)\r\n//| where Status != \"Completed\"\r\n| extend NameOfResource = tostring(properties.entityFriendlyName)\r\n| where NameOfResource == \"{NameParam}\"\r\n| extend ErrorInfo = properties['errorDetails'][0]['errorString']\r\n| extend Recommendation = properties['errorDetails'][0]['recommendations']\r\n| project Status, NameOfResource, id \r\n| sort by Status desc",
                      "size": 2,
                      "title": "Select Resource To See Details",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Status",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Failed",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true
                      }
                    },
                    "customWidth": "35",
                    "name": "query - 0 - Copy - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "BackupsOverview"
              },
              "name": "Backups-Step-Group"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "BackupReport"
        },
        "name": "Backups-Step-Group"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Monitoring and Security",
          "items": [
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "ed3b3650-dd46-4a66-9acd-cbda10b14c04",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Active Alerts",
                    "subTarget": "alerts",
                    "preText": "Active Alerts",
                    "style": "link"
                  },
                  {
                    "id": "1b181560-7b87-4f30-886c-2054a3648401",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Log Analytics",
                    "subTarget": "loganalytics",
                    "preText": "Log Analytics",
                    "style": "link"
                  },
                  {
                    "id": "bd1efa60-3841-4fa4-a336-485ab7462a6d",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Vulnerability Assessment",
                    "subTarget": "SecurityGroup",
                    "style": "link"
                  },
                  {
                    "id": "02418ea4-abb7-418e-8e30-420dbc42dd5a",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Azure Defender",
                    "subTarget": "AzureDefender",
                    "style": "link"
                  },
                  {
                    "id": "9f6a3518-f08a-44fc-9cfd-2a407ec50159",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Vulnerability by VM",
                    "subTarget": "VulnerabiltybyVM",
                    "style": "link"
                  },
                  {
                    "id": "0508e234-f34d-43de-8011-95666b9b23e2",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Defender for Cloud Alerts",
                    "subTarget": "DFCAlerts",
                    "style": "link"
                  },
                  {
                    "id": "4cf829b9-252d-4ada-b804-696cd88b38ea",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Malicious Connections",
                    "subTarget": "MaliciousConnections",
                    "style": "link"
                  }
                ]
              },
              "name": "links - Monitor & Security - Tabs",
              "styleSettings": {
                "showBorder": true
              }
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "AlertsManagementResources\r\n| extend AlertStatus = properties.essentials.monitorCondition\r\n| extend AlertState = properties.essentials.alertState\r\n| extend AlertTime = properties.essentials.startDateTime\r\n| extend AlertSuppressed = properties.essentials.actionStatus.isSuppressed\r\n| extend Severity = properties.essentials.severity\r\n| extend AffectedItem = properties.context.AffectedConfigurationItems\r\n| extend AlertDescription = properties.essentials.description\r\n| where AlertStatus == 'Fired'\r\n| extend Details = pack_all()\r\n| project id, name, subscriptionId, AffectedItem, Severity, AlertDescription, Details\r\n//| project id, name, subscriptionId, resourceGroup, AlertStatus, AlertState, AlertTime, AlertSuppressed, Severity, Details",
                      "size": 2,
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "id",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "name",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "AffectedItem",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Severity",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "AlertDescription",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "120ch"
                            }
                          },
                          {
                            "columnMatch": "Details",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Details",
                              "linkIsContextBlade": true
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "subscriptionId"
                          ],
                          "expandTopLevel": true
                        }
                      }
                    },
                    "name": "query - Monitor & Security - Active Alerts"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "alerts"
              },
              "name": "group - Active Alerts"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "### Log Analytics workspaces with enabled Solutions\r\n\r\n Select workspace to see data tables and resources logging to that workspace\r\n"
                    },
                    "name": "text - Monitor & Security - workspace details"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "resources\r\n| where type == \"microsoft.operationsmanagement/solutions\"\r\n| project Solution=plan.name, Workspace=tolower(tostring(properties.workspaceResourceId)), subscriptionId\r\n\t| join kind=leftouter(\r\n\t\tresources\r\n\t\t| where type =~ 'microsoft.operationalinsights/workspaces'\r\n\t\t| project Workspace=tolower(tostring(id)),subscriptionId) on Workspace\r\n| summarize Solutions = strcat_array(make_list(Solution), \",\") by Workspace, subscriptionId\r\n| extend AzureSecurityCenter = iif(Solutions has 'Security','Enabled','Not Enabled')\r\n| extend AzureMonitorVMs = iif(Solutions has \"VMInsights\",'Enabled','Not Enabled')\r\n| extend ChangeTracking = iif(Solutions has 'ChangeTracking','Enabled','Not Enabled')\r\n| extend UpdateManagement = iif(Solutions has 'Updates','Enabled','Not Enabled')\r\n\r\n",
                      "size": 4,
                      "exportedParameters": [
                        {
                          "fieldName": "Workspace",
                          "parameterName": "workspace",
                          "parameterType": 5
                        }
                      ],
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Workspace",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Solutions",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "AzureSecurityCenter",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AzureSecurityCenterFree",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AzureSentinel",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AzureMonitorVMs",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "ServiceDesk",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AzureAutomation",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "ChangeTracking",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "UpdateManagement",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "UpdateCompliance",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "AzureMonitorContainers",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "KeyVaultAnalytics",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          },
                          {
                            "columnMatch": "SQLHealthCheck",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Not Enabled",
                                  "representation": "disabled",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "Available",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ],
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "subscriptionId"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "Workspace"
                        }
                      },
                      "sortBy": []
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "loganalytics"
                    },
                    "name": "query - Monitoring Security Overview"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| extend Sku = properties.sku.name\r\n| extend RetentionInDays = properties.retentionInDays\r\n| extend Details = pack_all()\r\n| project Workspace=id, resourceGroup, location, subscriptionId, Sku, RetentionInDays, Details",
                      "size": 2,
                      "exportedParameters": [
                        {
                          "fieldName": "workspace",
                          "parameterName": "workspace",
                          "parameterType": 5
                        }
                      ],
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "Workspace",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Sku",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "RetentionInDays",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Details",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Details",
                              "linkIsContextBlade": true
                            }
                          }
                        ],
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "subscriptionId"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "Workspace"
                        }
                      },
                      "sortBy": []
                    },
                    "name": "query - Monitoring Security Overview - Copy"
                  },
                  {
                    "type": 1,
                    "content": {
                      "json": "\r\n\r\n Workspace table usage for selected workspace on the left, resources reported to selected workspace on the right."
                    },
                    "name": "text - Monitor & Security - workspace table usage"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Usage\r\n| summarize Size = sum(Quantity) by ['Table Name'] = DataType\r\n| sort by Size desc",
                      "size": 2,
                      "noDataMessageStyle": 5,
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "exportedParameters": [
                        {
                          "fieldName": "workspace",
                          "parameterName": "workspace",
                          "parameterType": 5
                        }
                      ],
                      "showExportToExcel": true,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Size",
                            "formatter": 3,
                            "formatOptions": {
                              "palette": "orange",
                              "customColumnWidthSetting": "341px"
                            },
                            "numberFormat": {
                              "unit": 38,
                              "options": {
                                "style": "decimal"
                              }
                            }
                          }
                        ],
                        "rowLimit": 500,
                        "filter": true
                      },
                      "sortBy": []
                    },
                    "customWidth": "50",
                    "name": "query - Monitoring Security - Workspace Usage - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "search * | distinct _ResourceId, SubscriptionId",
                      "size": 2,
                      "noDataMessageStyle": 5,
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "exportedParameters": [
                        {
                          "fieldName": "workspace",
                          "parameterName": "workspace",
                          "parameterType": 5
                        }
                      ],
                      "showExportToExcel": true,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{LogAnalytics}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "_ResourceId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "SubscriptionId",
                            "formatter": 5
                          }
                        ],
                        "rowLimit": 500,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "SubscriptionId"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "_ResourceId"
                        }
                      },
                      "sortBy": []
                    },
                    "customWidth": "50",
                    "name": "query - Monitoring Security - Workspace Usage"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "loganalytics"
              },
              "name": "group - LogAnalytics"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "parameters": [
                        {
                          "id": "fc5c3518-ac1c-471c-a204-6e3e960e94b2",
                          "version": "KqlParameterItem/1.0",
                          "name": "Severity",
                          "type": 5,
                          "isRequired": true,
                          "multiSelect": true,
                          "quote": "'",
                          "delimiter": ",",
                          "query": "securityresources\r\n | where type == \"microsoft.security/assessments\"\r\n //| where properties.metadata has \"(powered by Qualys)\"\r\n | summarize by assessmentKey=name //the ID of the assessment\r\n | join kind=inner (\r\n    securityresources\r\n     | where type == \"microsoft.security/assessments/subassessments\"\r\n     | extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n ) on assessmentKey\r\n| project assessmentKey, subassessmentKey=name, id, parse_json(properties), resourceGroup, subscriptionId, tenantId\r\n| extend severity = tostring(properties.status.severity)\r\n| distinct severity\r\n| order by severity asc\r\n",
                          "crossComponentResources": [
                            "{Subscriptions}"
                          ],
                          "value": [
                            "value::all"
                          ],
                          "typeSettings": {
                            "additionalResourceOptions": [
                              "value::all"
                            ],
                            "selectAllValue": "*",
                            "showDefault": false
                          },
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        }
                      ],
                      "style": "above",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    "name": "parameters - 16"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n | where type == \"microsoft.security/assessments\"\r\n //| where properties.metadata has \"(powered by Qualys)\"\r\n | summarize by assessmentKey=name //the ID of the assessment\r\n | join kind=inner (\r\n    securityresources\r\n     | where type == \"microsoft.security/assessments/subassessments\"\r\n     | extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n ) on assessmentKey\r\n| project assessmentKey, subassessmentKey=name, id, parse_json(properties), resourceGroup, subscriptionId, tenantId\r\n| extend description = properties.description,\r\n         displayName = properties.displayName,\r\n         resourceId = properties.resourceDetails.id,\r\n         resourceSource = properties.resourceDetails.source,\r\n         category = properties.category,\r\n         severity = properties.status.severity,\r\n         code = properties.status.code,\r\n         timeGenerated = properties.timeGenerated,\r\n         remediation = properties.remediation,\r\n         impact = properties.impact,\r\n         vulnId = properties.id,\r\n         additionalData = properties.additionalData\r\n| summarize count() by  tostring(severity), tostring(category)",
                      "size": 1,
                      "title": "Severity",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "piechart",
                      "chartSettings": {
                        "seriesLabelSettings": [
                          {
                            "seriesName": "Low",
                            "color": "green"
                          },
                          {
                            "seriesName": "Medium",
                            "color": "orange"
                          },
                          {
                            "seriesName": "High",
                            "color": "redBright"
                          }
                        ]
                      }
                    },
                    "customWidth": "25",
                    "name": "query - 14"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n | where type == \"microsoft.security/assessments\"\r\n//| where properties.metadata has \"(powered by Qualys)\"\r\n | summarize by assessmentKey=name //the ID of the assessment\r\n | join kind=inner (\r\n    securityresources\r\n     | where type == \"microsoft.security/assessments/subassessments\"\r\n     | extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n ) on assessmentKey\r\n| project assessmentKey, subassessmentKey=name, id, parse_json(properties), resourceGroup, subscriptionId, tenantId\r\n| extend description = properties.description,\r\n         displayName = properties.displayName,\r\n         resourceId = properties.resourceDetails.id,\r\n         resourceSource = properties.resourceDetails.source,\r\n         category = properties.category,\r\n         severity = properties.status.severity,\r\n         code = properties.status.code,\r\n         timeGenerated = properties.timeGenerated,\r\n         remediation = properties.remediation,\r\n         impact = properties.impact,\r\n         vulnId = properties.id,\r\n         additionalData = properties.additionalData\r\n| summarize count() by tostring(displayName), tostring(severity), tostring(category)",
                      "size": 1,
                      "title": "Description",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "piechart"
                    },
                    "customWidth": "41",
                    "name": "query - 13"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n | where type == \"microsoft.security/assessments\"\r\n //| where properties.metadata has \"(powered by Qualys)\"\r\n | summarize by assessmentKey=name //the ID of the assessment\r\n | join kind=inner (\r\n    securityresources\r\n     | where type == \"microsoft.security/assessments/subassessments\"\r\n     | extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n ) on assessmentKey\r\n| project assessmentKey, subassessmentKey=name, id, parse_json(properties), resourceGroup, subscriptionId, tenantId\r\n| extend description = properties.description,\r\n         displayName = properties.displayName,\r\n         resourceId = properties.resourceDetails.id,\r\n         resourceSource = properties.resourceDetails.source,\r\n         category = properties.category,\r\n         severity = properties.status.severity,\r\n         code = properties.status.code,\r\n         timeGenerated = properties.timeGenerated,\r\n         remediation = properties.remediation,\r\n         impact = properties.impact,\r\n         vulnId = properties.id,\r\n         additionalData = properties.additionalData\r\n| summarize count() by   tostring(category)",
                      "size": 1,
                      "title": "Category",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "piechart"
                    },
                    "customWidth": "33",
                    "name": "query - 14 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n | where type == \"microsoft.security/assessments\"\r\n //| where properties.metadata has \"(powered by Qualys)\"\r\n | summarize by assessmentKey=name //the ID of the assessment\r\n | join kind=inner (\r\n    securityresources\r\n     | where type == \"microsoft.security/assessments/subassessments\"\r\n     | extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n ) on assessmentKey\r\n| project Customer=subscriptionId, description = properties.description, severity = properties.status.severity, id, parse_json(properties), resourceGroup\r\n| extend category = properties.category,\r\n         code = properties.status.code,\r\n         remediation = properties.remediation,\r\n         vulnId = properties.id,\r\n         timeGenerated = properties.timeGenerated,\r\n         additionalData = properties.additionalData\r\n| where \"*\" in ({Severity})  or severity in ({Severity}) \r\n",
                      "size": 3,
                      "title": "Full details by severity: {Severity},  {$rowCount} rows",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Customer",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": "Resource",
                              "showIcon": true
                            }
                          }
                        ],
                        "filter": true
                      },
                      "sortBy": []
                    },
                    "name": "query - 14 - grid report"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "SecurityGroup"
              },
              "name": "group - 11"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Azure Defender: VM vulnerability alerts",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n| where type =~ \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey=extract(\"providers/Microsoft.Security/assessments/([^/]*)\", 1, id), subAssessmentId=tostring(properties.id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n//| extend subAssessmentName=tostring(properties.displayName), resourceId = tostring(properties.resourceDetails.id)\r\n| summarize count() by tostring(properties.status.severity)\r\n",
                      "size": 4,
                      "title": "VM vulnerability alerts",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "piechart",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "count_",
                            "formatter": 8,
                            "formatOptions": {
                              "palette": "greenRed"
                            }
                          }
                        ],
                        "filter": true
                      }
                    },
                    "customWidth": "50",
                    "name": "query - 0 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n| where type =~ \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey=extract(\"providers/Microsoft.Security/assessments/([^/]*)\", 1, id), subAssessmentId=tostring(properties.id)\r\n| where assessmentKey != \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| summarize count() by  tostring(properties.status.severity)\r\n//== \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n\r\n",
                      "size": 4,
                      "title": "Other vulnerability alerts",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "piechart",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "count_",
                            "formatter": 8,
                            "formatOptions": {
                              "palette": "greenRed"
                            }
                          }
                        ],
                        "filter": true
                      }
                    },
                    "customWidth": "50",
                    "name": "query - 0 - Copy - Copy"
                  },
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "parameters": [
                        {
                          "id": "b1b112e9-4ea2-4a4b-9f86-d9cb8343de9e",
                          "version": "KqlParameterItem/1.0",
                          "name": "selectSeverity",
                          "type": 10,
                          "isRequired": true,
                          "typeSettings": {
                            "additionalResourceOptions": [],
                            "showDefault": false
                          },
                          "jsonData": "[\r\n {\"value\": \"Show All\", \"label\": \"Show All\", \"selected\":true },\r\n {\"value\": \"High\", \"label\": \"High\"},\r\n {\"value\": \"Medium\", \"label\": \"Medium\"},\r\n {\"value\": \"Low\", \"label\": \"Low\"}\r\n]",
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "label": "Select Severity",
                          "value": "High"
                        }
                      ],
                      "style": "above",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    "name": "parameters - 2"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n                    | where type =~ \"microsoft.security/assessments/subassessments\"\r\n                    | extend assessmentKey=extract(\"providers/Microsoft.Security/assessments/([^/]*)\", 1, id), subAssessmentId=tostring(properties.id)\r\n                    | where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n                    | where properties.status.severity == '{selectSeverity}' or \"Show All\" == \"{selectSeverity}\"\r\n                    | extend subAssessmentName=tostring(properties.displayName), \r\n                             resourceId = tostring(properties.resourceDetails.id), \r\n                             cve = tostring(properties.additionalData.cve),\r\n                             statusSeverity = tostring(properties.status.severity),\r\n                             statusCode = tostring(properties.status.code),\r\n                             vendorTitle = tostring(properties.additionalData.vendorReferences)\r\n                    | summarize count(), make_set(statusSeverity), make_set(subAssessmentName), make_set(cve), make_set(vendorTitle) by  resourceId\r\n                    //, subAssessmentName, statusSeverity, statusCode,cve, vendorTitle\r\n                  | order by(count_)",
                      "size": 2,
                      "title": "VM vulnerability alerts by Severity",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "count_",
                            "formatter": 8,
                            "formatOptions": {
                              "palette": "greenRed"
                            }
                          },
                          {
                            "columnMatch": "cve",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkIsContextBlade": true
                            }
                          },
                          {
                            "columnMatch": "vendorTitle",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "GenericDetails",
                              "linkIsContextBlade": true
                            }
                          }
                        ],
                        "filter": true
                      },
                      "sortBy": []
                    },
                    "name": "query - 0 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n| where type =~ \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey=extract(\"providers/Microsoft.Security/assessments/([^/]*)\", 1, id), subAssessmentId=tostring(properties.id)\r\n| where properties.status.severity == '{selectSeverity}' or \"Show All\" == \"{selectSeverity}\"\r\n| where assessmentKey != \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| summarize count() by tostring(properties.additionalData.assessedResourceType), tostring(properties.status.severity), tostring(properties.displayName)\r\n//== \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n\r\n",
                      "size": 1,
                      "title": "Other vulnerability alerts",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "count_",
                            "formatter": 8,
                            "formatOptions": {
                              "palette": "greenRed"
                            }
                          }
                        ],
                        "filter": true
                      }
                    },
                    "name": "query - 0 - Copy - Copy - Copy"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "AzureDefender"
              },
              "name": "group - AzureDefender"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Vulnerability by VM",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "### This workbook is based on the following recommendations provided by Defender for Cloud:\r\n* [Machines should have vulnerability findings resolved](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1195afff-c881-495e-9bc5-1486211ae03f)\r\n"
                    },
                    "name": "text - 3"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n | project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, severity = tostring(parse_json(properties).status.severity), status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), description = tostring(parse_json(properties).displayName), patchable = parse_json(properties.additionalData).patchable, cve = parse_json(properties.additionalData).cve\r\n | where status == 'Unhealthy'\r\n | summarize dcount(VulnId) by ResourceGroup, Resource, severity, VulnId, description, tostring(patchable), tostring(cve)\r\n | summarize Total = count(dcount_VulnId), sevH=countif(severity=='High'), sevM=countif(severity=='Medium'), sevL=countif(severity=='Low'), patchAvailable = countif(patchable=='true'), CVEcount =countif(cve!='[]') by ResourceGroup, Resource\r\n | order by sevH desc",
                      "size": 0,
                      "title": "Overview | Select a machine to view the list of vulnerabilities",
                      "exportFieldName": "Resource",
                      "exportParameterName": "selectedServer",
                      "exportDefaultValue": "All",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 13,
                            "formatOptions": {
                              "linkColumn": "Resource",
                              "linkTarget": "Resource",
                              "showIcon": true,
                              "customColumnWidthSetting": "30ch"
                            }
                          },
                          {
                            "columnMatch": "ResourceGroup",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Resource",
                            "formatter": 5,
                            "formatOptions": {
                              "customColumnWidthSetting": "20ch"
                            }
                          },
                          {
                            "columnMatch": "Total",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "sevH",
                            "formatter": 4,
                            "formatOptions": {
                              "palette": "redBright",
                              "customColumnWidthSetting": "12ch"
                            }
                          },
                          {
                            "columnMatch": "sevM",
                            "formatter": 4,
                            "formatOptions": {
                              "palette": "yellow",
                              "customColumnWidthSetting": "13ch"
                            }
                          },
                          {
                            "columnMatch": "sevL",
                            "formatter": 4,
                            "formatOptions": {
                              "palette": "blueDark",
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "patchAvailable",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "pending",
                                  "text": "{0}{1}"
                                }
                              ],
                              "compositeBarSettings": {
                                "labelText": "",
                                "columnSettings": []
                              },
                              "customColumnWidthSetting": "20ch"
                            }
                          },
                          {
                            "columnMatch": "CVEcount",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "4",
                                  "text": "{0}{1}"
                                }
                              ],
                              "customColumnWidthSetting": "10ch"
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "ResourceGroup"
                          ],
                          "expandTopLevel": true,
                          "finalBy": "Resource"
                        },
                        "labelSettings": [
                          {
                            "columnId": "ResourceGroup",
                            "label": "Resource group"
                          },
                          {
                            "columnId": "sevH",
                            "label": "High"
                          },
                          {
                            "columnId": "sevM",
                            "label": "Medium"
                          },
                          {
                            "columnId": "sevL",
                            "label": "Low"
                          },
                          {
                            "columnId": "patchAvailable",
                            "label": "Available patches"
                          },
                          {
                            "columnId": "CVEcount",
                            "label": "CVEs"
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "customWidth": "60",
                    "name": "MachinesSummary"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| extend Category = tostring(properties.category), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| summarize count() by tostring(Category)",
                      "size": 0,
                      "title": "Vulnerabilities by category",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "visualization": "tiles",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "$gen_group",
                            "formatter": 14,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true,
                              "customColumnWidthSetting": "25ch"
                            }
                          },
                          {
                            "columnMatch": "ResourceGroup",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Resource",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "20ch"
                            }
                          },
                          {
                            "columnMatch": "Total",
                            "formatter": 1,
                            "formatOptions": {
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "sevH",
                            "formatter": 4,
                            "formatOptions": {
                              "palette": "red",
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "sevM",
                            "formatter": 4,
                            "formatOptions": {
                              "palette": "orange",
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "sevL",
                            "formatter": 4,
                            "formatOptions": {
                              "palette": "blueDark",
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "patchAvailable",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "pending",
                                  "text": "{0}{1}"
                                }
                              ],
                              "compositeBarSettings": {
                                "labelText": "",
                                "columnSettings": []
                              },
                              "customColumnWidthSetting": "10ch"
                            }
                          },
                          {
                            "columnMatch": "CVEcount",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "icons",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "4",
                                  "text": "{0}{1}"
                                }
                              ],
                              "customColumnWidthSetting": "10ch"
                            }
                          }
                        ],
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "ResourceGroup"
                          ],
                          "expandTopLevel": true
                        }
                      },
                      "sortBy": [],
                      "tileSettings": {
                        "titleContent": {
                          "columnMatch": "Category",
                          "formatter": 1
                        },
                        "leftContent": {
                          "columnMatch": "count_",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "useGrouping": false,
                              "maximumFractionDigits": 2,
                              "maximumSignificantDigits": 3
                            }
                          }
                        },
                        "showBorder": true
                      }
                    },
                    "customWidth": "40",
                    "name": "MachinesCategoryTiles"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"1195afff-c881-495e-9bc5-1486211ae03f\"\r\n| project Resource = tolower(extract(\"([\\\\s\\\\S]*?)(/providers/Microsoft.Security.*)\",1,id)), ResourceGroup = trim_end(\"/\",extract(\".*resourceGroups/(.+?)/\",0,id)), ResourceType = tolower(split(id,\"/\").[6]), subscriptionId, Severity = tostring(parse_json(properties).status.severity), Status = tostring(parse_json(properties).status.code), VulnId = tostring(parse_json(properties).id), Description = tostring(parse_json(properties).displayName), Patchable = parse_json(properties.additionalData).patchable, CVE = properties.additionalData.cve, Category = tostring(properties.category), TimeGenerated = tostring(properties.timeGenerated), Remediation = tostring(properties.remediation), Impact = tostring(properties.impact), Threat = tostring(properties.additionalData.threat)\r\n| where Status == 'Unhealthy'\r\n| where '{selectedServer}' == 'All' or Resource == '{selectedServer}'\r\n| project Severity, VulnId, Description, tostring(Patchable), Category, Resource, ResourceGroup, CVE, TimeGenerated, Remediation, Impact, Threat\r\n| mv-expand CveExpand = split (CVE, \"},\") to typeof(string)\r\n| parse CveExpand with * '\"title\":\"' singleCve '\"' *\r\n| summarize CVEs = tostring(make_list(singleCve)) by Severity, VulnId, Description, tostring(Patchable), Category, Resource, ResourceGroup, TimeGenerated, Threat, Impact, Remediation",
                      "size": 2,
                      "title": "Use the search box to filter vulnerabilities by resource, resource group, CVE, severity, etc.",
                      "showExportToExcel": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Severity",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "VulnId",
                            "formatter": 5
                          },
                          {
                            "columnMatch": "Resource",
                            "formatter": 0,
                            "formatOptions": {
                              "customColumnWidthSetting": "25ch"
                            }
                          },
                          {
                            "columnMatch": "TimeGenerated",
                            "formatter": 6,
                            "formatOptions": {
                              "customColumnWidthSetting": "25ch"
                            }
                          },
                          {
                            "columnMatch": "Remediation",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "GenericDetails",
                              "linkIsContextBlade": true
                            }
                          }
                        ],
                        "rowLimit": 1000,
                        "filter": true,
                        "hierarchySettings": {
                          "treeType": 1,
                          "groupBy": [
                            "Severity"
                          ],
                          "finalBy": "VulnId"
                        },
                        "sortBy": [
                          {
                            "itemKey": "Description",
                            "sortOrder": 1
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "Description",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "name": "Servers - FullListTable"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "VulnerabiltybyVM"
              },
              "name": "group - VulnerabiltybyVM"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "DFC Alerts",
                "items": [
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "  securityresources\r\n  | where type =~ 'microsoft.security/locations/alerts'\r\n  | extend Severity = tostring(properties.Severity)\r\n  | summarize count() by Severity, subscriptionId",
                      "size": 4,
                      "exportFieldName": "Severity",
                      "exportParameterName": "SeverityParam",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          }
                        ],
                        "sortBy": [
                          {
                            "itemKey": "Severity",
                            "sortOrder": 1
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "Severity",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "name": "query - 5 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "  securityresources\r\n  | where type =~ 'microsoft.security/locations/alerts'\r\n  | where properties.Severity == \"{SeverityParam}\"\r\n  | extend Details=pack_all()\r\n  | extend RemediationSteps = properties.RemediationSteps\r\n  | extend Severity = properties.Severity\r\n  | project AlertStartTime=properties.StartTimeUtc, AlertName=properties.AlertDisplayName, subscriptionId, AlertStatus=properties.Status, Intent=properties.Intent, Severity, RemediationSteps, Details",
                      "size": 0,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "crossComponentResources": [
                        "{Subscriptions}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "AlertStartTime",
                            "formatter": 6
                          },
                          {
                            "columnMatch": "AlertName",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "subscriptionId",
                            "formatter": 13,
                            "formatOptions": {
                              "linkTarget": null,
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "AlertStatus",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Intent",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Severity",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "RemediationSteps",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "Details",
                            "formatter": 7,
                            "formatOptions": {
                              "linkTarget": "CellDetails",
                              "linkLabel": " View Details",
                              "linkIsContextBlade": true
                            }
                          },
                          {
                            "columnMatch": "properties_Status",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "properties_Intent",
                            "formatter": 1
                          },
                          {
                            "columnMatch": "properties_Severity",
                            "formatter": 1
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "name": "query - 5"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "DFCAlerts"
              },
              "name": "group - DFC Alerts"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 11,
                    "content": {
                      "version": "LinkItem/1.0",
                      "style": "tabs",
                      "links": [
                        {
                          "id": "9b816ed9-4ddf-43be-a153-739fce2fa287",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Overview",
                          "subTarget": "Overview",
                          "style": "link"
                        },
                        {
                          "id": "92e203ba-bf11-4aa1-b72f-e259712f06e3",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Malicious IPs",
                          "subTarget": "MaliciousIPs",
                          "preText": "Malicious IPs",
                          "style": "link"
                        },
                        {
                          "id": "bfa1fe35-7758-4680-a078-2ef3b3bcdda7",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Traffic by Country",
                          "subTarget": "TrafficbyCountry",
                          "style": "link"
                        }
                      ]
                    },
                    "name": "links - 5"
                  },
                  {
                    "type": 9,
                    "content": {
                      "version": "KqlParameterItem/1.0",
                      "parameters": [
                        {
                          "id": "5d2dc4ec-fa68-42f2-848d-9d9f0a05a5af",
                          "version": "KqlParameterItem/1.0",
                          "name": "TimeRange",
                          "type": 4,
                          "isRequired": true,
                          "typeSettings": {
                            "selectableValues": [
                              {
                                "durationMs": 300000
                              },
                              {
                                "durationMs": 900000
                              },
                              {
                                "durationMs": 1800000
                              },
                              {
                                "durationMs": 3600000
                              },
                              {
                                "durationMs": 14400000
                              },
                              {
                                "durationMs": 43200000
                              },
                              {
                                "durationMs": 86400000
                              },
                              {
                                "durationMs": 172800000
                              },
                              {
                                "durationMs": 259200000
                              },
                              {
                                "durationMs": 604800000
                              },
                              {
                                "durationMs": 1209600000
                              },
                              {
                                "durationMs": 2419200000
                              },
                              {
                                "durationMs": 2592000000
                              },
                              {
                                "durationMs": 5184000000
                              },
                              {
                                "durationMs": 7776000000
                              }
                            ]
                          },
                          "timeContext": {
                            "durationMs": 86400000
                          },
                          "value": {
                            "durationMs": 86400000
                          }
                        }
                      ],
                      "style": "pills",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces"
                    },
                    "name": "parameters - 4"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "items": [
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "items": [
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "VMConnection\r\n| where RemoteCountry != \"\"\r\n| where Severity > 0\r\n| summarize count() by RemoteLongitude, RemoteLatitude, RemoteCountry\r\n//| summarize count() by ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteCountry\r\n| sort by count_\r\n",
                                  "size": 0,
                                  "title": "Malicious IP Connections by Country",
                                  "timeContextFromParameter": "TimeRange",
                                  "queryType": 0,
                                  "resourceType": "microsoft.operationalinsights/workspaces",
                                  "crossComponentResources": [
                                    "{LogAnalytics}"
                                  ],
                                  "visualization": "map",
                                  "mapSettings": {
                                    "locInfo": "LatLong",
                                    "latitude": "RemoteLatitude",
                                    "longitude": "RemoteLongitude",
                                    "sizeSettings": "count_",
                                    "sizeAggregation": "Sum",
                                    "minSize": 20,
                                    "maxSize": 30,
                                    "labelSettings": "RemoteCountry",
                                    "legendMetric": "count_",
                                    "legendAggregation": "Sum",
                                    "itemColorSettings": {
                                      "nodeColorField": "count_",
                                      "colorAggregation": "Sum",
                                      "type": "heatmap",
                                      "heatmapPalette": "greenRed"
                                    }
                                  }
                                },
                                "name": "query - 2"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "selectedTab",
                            "comparison": "isEqualTo",
                            "value": "Overview"
                          },
                          "name": "group - Overview"
                        }
                      ]
                    },
                    "name": "group - 1"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "items": [
                        {
                          "type": 9,
                          "content": {
                            "version": "KqlParameterItem/1.0",
                            "parameters": [
                              {
                                "id": "02aca104-72af-4a91-ad09-9b9827a2d19f",
                                "version": "KqlParameterItem/1.0",
                                "name": "TrafficDirection",
                                "label": "Traffic Direction",
                                "type": 10,
                                "isRequired": true,
                                "typeSettings": {
                                  "additionalResourceOptions": [],
                                  "showDefault": false
                                },
                                "jsonData": "[\r\n {\"value\": \"inbound\", \"label\":\"Inbound\", \"selected\":true},\r\n {\"value\": \"outbound\", \"label\":\"Outbound\"}\r\n]",
                                "timeContext": {
                                  "durationMs": 86400000
                                }
                              }
                            ],
                            "style": "formHorizontal",
                            "queryType": 0,
                            "resourceType": "microsoft.operationalinsights/workspaces"
                          },
                          "name": "parameters - 2"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "VMConnection\r\n| where Severity > 0\r\n| where Direction == \"{TrafficDirection}\"\r\n| extend Subscription = tostring(split(_ResourceId, '/')[2])\r\n| project TimeGenerated, Subscription, _ResourceId, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, Protocol, RemoteCountry, IndicatorThreatType, Severity, BytesSent, BytesReceived, LinksLive, LinksTerminated, LinksEstablished, LinksFailed, Responses, ResponseTimeSum, ResponseTimeMin, ResponseTimeMax, Confidence, FirstReportedDateTime, LastReportedDateTime, IsActive, MaliciousIp\r\n| sort by TimeGenerated",
                            "size": 0,
                            "showAnalytics": true,
                            "title": "Malicious Connections",
                            "timeContextFromParameter": "TimeRange",
                            "exportFieldName": "MaliciousIp",
                            "exportParameterName": "MaliciousIpparam",
                            "showExportToExcel": true,
                            "queryType": 0,
                            "resourceType": "microsoft.operationalinsights/workspaces",
                            "crossComponentResources": [
                              "{LogAnalytics}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "Subscription",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "SubId",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": true
                                  }
                                }
                              ],
                              "rowLimit": 2000,
                              "filter": true,
                              "sortBy": [
                                {
                                  "itemKey": "TimeGenerated",
                                  "sortOrder": 1
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "TimeGenerated",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "name": "query - 1"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "VMConnection\r\n| where SourceIp == '{MaliciousIpparam}'",
                            "size": 0,
                            "title": "Select Item Above - To View More Details",
                            "timeContextFromParameter": "TimeRange",
                            "exportFieldName": "MaliciousIp",
                            "exportParameterName": "Malcious",
                            "queryType": 0,
                            "resourceType": "microsoft.operationalinsights/workspaces",
                            "crossComponentResources": [
                              "{LogAnalytics}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": true
                                  }
                                }
                              ]
                            },
                            "sortBy": []
                          },
                          "name": "query - 1 - Copy"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "MaliciousIPs"
                    },
                    "name": "group - MaliciousIPs"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "VMConnection\r\n| where RemoteCountry != \"\"\r\n| where RemoteCountry != \"United States\"\r\n| where Direction == \"outbound\"\r\n| summarize sum(BytesReceived), sum(BytesSent) by RemoteCountry, Direction",
                            "size": 1,
                            "title": "Outbound Traffic by Country",
                            "timeContextFromParameter": "TimeRange",
                            "exportFieldName": "RemoteCountry",
                            "exportParameterName": "paramRemoteCountry",
                            "queryType": 0,
                            "resourceType": "microsoft.operationalinsights/workspaces",
                            "crossComponentResources": [
                              "{LogAnalytics}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": true
                                  }
                                }
                              ],
                              "sortBy": [
                                {
                                  "itemKey": "sum_BytesSent",
                                  "sortOrder": 2
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "sum_BytesSent",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "name": "query - Outbound Traffic by Country"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "VMConnection\r\n| where RemoteCountry == '{paramRemoteCountry}'\r\n| where Direction == \"outbound\"\r\n",
                            "size": 2,
                            "title": "Select Country Above to View Details on Connections",
                            "noDataMessage": "Select Country Above to View Details",
                            "timeContextFromParameter": "TimeRange",
                            "queryType": 0,
                            "resourceType": "microsoft.operationalinsights/workspaces",
                            "crossComponentResources": [
                              "{LogAnalytics}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": null,
                                    "showIcon": true
                                  }
                                }
                              ],
                              "sortBy": [
                                {
                                  "itemKey": "BytesSent",
                                  "sortOrder": 2
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "BytesSent",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "name": "query - By Country"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "TrafficbyCountry"
                    },
                    "name": "group - TrafficbyCountry"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "MaliciousConnections"
              },
              "name": "group - 7"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "monitor"
        },
        "name": "group - Monitoring and Security"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Patch Management Group",
          "items": [
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "crossComponentResources": [
                  "{Subscriptions}"
                ],
                "parameters": [
                  {
                    "id": "f8d6705a-e284-4077-8113-aae1038a6b7c",
                    "version": "KqlParameterItem/1.0",
                    "name": "Workspaces",
                    "type": 5,
                    "isRequired": true,
                    "multiSelect": true,
                    "quote": "'",
                    "delimiter": ",",
                    "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| summarize by id, name",
                    "crossComponentResources": [
                      "{Subscriptions}"
                    ],
                    "isHiddenWhenLocked": true,
                    "typeSettings": {
                      "additionalResourceOptions": [
                        "value::all"
                      ],
                      "showDefault": false
                    },
                    "defaultValue": "value::all",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  }
                ],
                "style": "pills",
                "queryType": 1,
                "resourceType": "microsoft.resourcegraph/resources"
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "patchmanagement"
              },
              "name": "parameters - 11"
            },
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "e21cf8dd-d59c-4d7a-8ca3-3e7267c09383",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Patch Management Overview",
                    "subTarget": "PatchManagementOverview",
                    "preText": "Patch Management Overview",
                    "style": "link"
                  },
                  {
                    "id": "fe386e18-e838-4f1b-952c-9377c1060c9e",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Update Summary By Computer",
                    "subTarget": "UpdateSummaryByComputer",
                    "style": "link"
                  },
                  {
                    "id": "a3e4650e-4d4e-42da-8ef6-f565c5ddc6e3",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Installation Failure By Machine",
                    "subTarget": "InstallationFailureByMachine",
                    "style": "link"
                  },
                  {
                    "id": "27d58b45-aeca-421f-8236-6191ae729a36",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Scheduled Updates",
                    "subTarget": "ScheduledUpdates",
                    "style": "link"
                  }
                ]
              },
              "name": "links - 16",
              "styleSettings": {
                "showBorder": true
              }
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "## Windows Updates needed by Classification"
                    },
                    "customWidth": "50",
                    "name": "text - 7"
                  },
                  {
                    "type": 1,
                    "content": {
                      "json": "## Top 5 Windows Machines by Update Count"
                    },
                    "customWidth": "50",
                    "name": "text - 8"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Update\r\n| where TimeGenerated>ago(14h) and OSType!=\"Linux\" and (Optional==false or Classification has \"Critical\" or Classification has \"Security\") and SourceComputerId in ((Heartbeat\r\n| where TimeGenerated>ago(12h) and OSType=~\"Windows\" and notempty(Computer)\r\n| summarize arg_max(TimeGenerated, Solutions) by SourceComputerId\r\n| where Solutions has \"updates\" | distinct SourceComputerId))\r\n| summarize hint.strategy=partitioned arg_max(TimeGenerated, *) by Computer, SourceComputerId, UpdateID\r\n| where UpdateState=~\"Needed\" and Approved!=false\r\n| summarize UpdatesNeeded=count(Classification) by Classification",
                      "size": 1,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ],
                      "visualization": "piechart",
                      "tileSettings": {
                        "showBorder": false,
                        "titleContent": {
                          "columnMatch": "Classification",
                          "formatter": 1
                        },
                        "leftContent": {
                          "columnMatch": "UpdatesNeeded",
                          "formatter": 12,
                          "formatOptions": {
                            "palette": "auto"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "maximumSignificantDigits": 3,
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      },
                      "chartSettings": {
                        "seriesLabelSettings": [
                          {
                            "seriesName": "Definition Updates",
                            "color": "yellow"
                          },
                          {
                            "seriesName": "Updates",
                            "color": "orange"
                          },
                          {
                            "seriesName": "Security Updates",
                            "color": "redBright"
                          },
                          {
                            "seriesName": "Update Rollups",
                            "color": "purple"
                          },
                          {
                            "seriesName": "Critical Updates",
                            "color": "red"
                          }
                        ]
                      }
                    },
                    "customWidth": "50",
                    "name": "query - 0"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Update\r\n| where TimeGenerated>ago(14h) and OSType!=\"Linux\" and (Optional==false or Classification has \"Critical\" or Classification has \"Security\") and SourceComputerId in ((Heartbeat\r\n| where TimeGenerated>ago(12h) and OSType=~\"Windows\" and notempty(Computer)\r\n| summarize arg_max(TimeGenerated, Solutions) by SourceComputerId\r\n| where Solutions has \"updates\" | distinct SourceComputerId))\r\n| summarize hint.strategy=partitioned arg_max(TimeGenerated, *) by Computer, SourceComputerId, UpdateID\r\n| where UpdateState=~\"Needed\" and Approved!=false\r\n| project Computer, Title, Classification, PublishedDate, UpdateState, Product\r\n| summarize count(Classification) by Computer \r\n| top 5 by count_Classification desc ",
                      "size": 1,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ],
                      "visualization": "piechart"
                    },
                    "customWidth": "50",
                    "name": "top five Computers Needing Updates"
                  },
                  {
                    "type": 1,
                    "content": {
                      "json": "## Servers Waiting to Reboot After Patches"
                    },
                    "name": "text - 13"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "// Devices pending reboot to complete update \r\n// Devices with pending reboot to complete update. \r\nUpdateSummary\r\n| where TimeGenerated between (ago(1d) .. now() )\r\n| where RestartPending == true\r\n| project TimeGenerated, LastUpdateApplied, ResourceId, Computer, OsVersion, RestartPending, CriticalUpdatesMissing, SecurityUpdatesMissing, ResourceGroup, SubscriptionId, OldestMissingSecurityUpdateInDays\r\n| order by TimeGenerated asc\r\n\r\n",
                      "size": 2,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ],
                      "gridSettings": {
                        "sortBy": [
                          {
                            "itemKey": "TimeGenerated",
                            "sortOrder": 2
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "TimeGenerated",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "name": "query - 14"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "PatchManagementOverview"
              },
              "name": "group - PatchManagementOverview"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "UpdateSummaryByComputer - Group",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "## Heatmap of Update Summary by Computer\r\n\r\nThis section is dynamic, by selecting a row that row's Computer name will be exported to populate Updates needed by Server"
                    },
                    "name": "text - 9 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Heartbeat\r\n| where TimeGenerated>ago(12h) and OSType=~\"Windows\" and notempty(Computer)\r\n| summarize arg_max(TimeGenerated, Solutions, Computer, ResourceId, ComputerEnvironment, VMUUID) by SourceComputerId\r\n| where Solutions has \"updates\"\r\n| extend vmuuId=VMUUID, azureResourceId=ResourceId, osType=2, environment=iff(ComputerEnvironment=~\"Azure\", 1, 2), scopedToUpdatesSolution=true, lastUpdateAgentSeenTime=\"\"\r\n| join kind=leftouter\r\n(\r\n    Update\r\n    | where TimeGenerated>ago(14h) and OSType!=\"Linux\" and SourceComputerId in ((Heartbeat\r\n    | where TimeGenerated>ago(12h) and OSType=~\"Windows\" and notempty(Computer)\r\n    | summarize arg_max(TimeGenerated, Solutions) by SourceComputerId\r\n    | where Solutions has \"updates\"\r\n    | distinct SourceComputerId))\r\n    | summarize hint.strategy=partitioned arg_max(TimeGenerated, UpdateState, Classification, Title, Optional, Approved, Computer, ComputerEnvironment) by Computer, SourceComputerId, UpdateID\r\n    | summarize Computer=any(Computer), ComputerEnvironment=any(ComputerEnvironment), missingCriticalUpdatesCount=countif(Classification has \"Critical\" and UpdateState=~\"Needed\" and Approved!=false), missingSecurityUpdatesCount=countif(Classification has \"Security\" and UpdateState=~\"Needed\" and Approved!=false), missingOtherUpdatesCount=countif(Classification !has \"Critical\" and Classification !has \"Security\" and UpdateState=~\"Needed\" and Optional==false and Approved!=false), lastAssessedTime=max(TimeGenerated), lastUpdateAgentSeenTime=\"\" by SourceComputerId\r\n    | extend compliance=iff(missingCriticalUpdatesCount > 0 or missingSecurityUpdatesCount > 0, 2, 1)\r\n    | extend ComplianceOrder=iff(missingCriticalUpdatesCount > 0 or missingSecurityUpdatesCount > 0 or missingOtherUpdatesCount > 0, 1, 3)\r\n)\r\non SourceComputerId\r\n| project id=SourceComputerId, displayName=Computer, sourceComputerId=SourceComputerId, scopedToUpdatesSolution=true, missingCriticalUpdatesCount=coalesce(missingCriticalUpdatesCount, -1), missingSecurityUpdatesCount=coalesce(missingSecurityUpdatesCount, -1), missingOtherUpdatesCount=coalesce(missingOtherUpdatesCount, -1), compliance=coalesce(compliance, 4), lastAssessedTime, lastUpdateAgentSeenTime, osType=2, environment=iff(ComputerEnvironment=~\"Azure\", 1, 2), ComplianceOrder=coalesce(ComplianceOrder, 2) \r\n| order by ComplianceOrder asc, missingCriticalUpdatesCount desc, missingSecurityUpdatesCount desc, missingOtherUpdatesCount desc, displayName asc\r\n| project displayName, scopedToUpdatesSolution, CriticalUpdates=missingCriticalUpdatesCount, SecurityUpdates=missingSecurityUpdatesCount, OtherUpdates=missingOtherUpdatesCount, compliance, osType, Environment=environment, lastAssessedTime, lastUpdateAgentSeenTime\r\n| extend osType = replace(@\"2\", @\"Windows\", tostring(osType))\r\n| extend osType = replace(@\"1\", @\"Linux\", tostring(osType))\r\n| extend Environment = replace(@\"2\", @\"Non-Azure\", tostring(Environment))\r\n| extend Environment = replace(@\"1\", @\"Azure\", tostring(Environment))",
                      "size": 0,
                      "exportFieldName": "displayName",
                      "exportParameterName": "Computer",
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ],
                      "visualization": "table",
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "CriticalUpdates",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 0,
                              "max": 1,
                              "palette": "greenRed",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "SecurityUpdates",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 0,
                              "max": 5,
                              "palette": "greenRed",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "OtherUpdates",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 0,
                              "max": 5,
                              "palette": "greenRed",
                              "showIcon": true
                            }
                          },
                          {
                            "columnMatch": "compliance",
                            "formatter": 8,
                            "formatOptions": {
                              "min": 1,
                              "max": 2,
                              "palette": "greenRed",
                              "showIcon": true
                            }
                          }
                        ],
                        "sortBy": [
                          {
                            "itemKey": "$gen_heatmap_SecurityUpdates_3",
                            "sortOrder": 2
                          }
                        ]
                      },
                      "sortBy": [
                        {
                          "itemKey": "$gen_heatmap_SecurityUpdates_3",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "name": "query - 2"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "Update\r\n| where TimeGenerated>ago(14h) and OSType!=\"Linux\" and (Optional==false or Classification has \"Critical\" or Classification has \"Security\") and SourceComputerId in ((Heartbeat\r\n| where TimeGenerated>ago(12h) and OSType=~\"Windows\" and notempty(Computer)\r\n| summarize arg_max(TimeGenerated, Solutions) by SourceComputerId\r\n| where Solutions has \"updates\" | distinct SourceComputerId))\r\n| summarize hint.strategy=partitioned arg_max(TimeGenerated, *) by Computer, SourceComputerId, UpdateID\r\n| where UpdateState=~\"Needed\" and Approved!=false and Computer=='{Computer}'\r\n| project Computer, Title, Classification, PublishedDate, UpdateState, Product",
                      "size": 2,
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "Classification",
                            "formatter": 18,
                            "formatOptions": {
                              "showIcon": true,
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "==",
                                  "thresholdValue": "Updates",
                                  "representation": "orange",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Security Updates",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Definition Updates",
                                  "representation": "yellow",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Update Rollups",
                                  "representation": "purple",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "==",
                                  "thresholdValue": "Critical Updates",
                                  "representation": "red",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "blue",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ]
                      }
                    },
                    "name": "query - 4"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "UpdateSummaryByComputer"
              },
              "name": "group - UpdateSummaryByComputer"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "InstallationFailureByMachine - Group",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "## Patch Installation Status Per Machine"
                    },
                    "name": "text - 10 - Copy"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "// Patch installation failure for your machines \r\n// List for each machine the installation status of the updates where the installation was not successful. \r\n// To create an alert for this query, click '+ New alert rule'\r\nUpdateRunProgress\r\n| where TimeGenerated>ago(1d) \r\n| where InstallationStatus == \"NotStarted\" \r\n| summarize by Title, InstallationStatus, SourceComputerId, UpdateId, Computer, ResourceId\r\n| join kind= inner (\r\n    UpdateRunProgress\r\n    | where TimeGenerated>ago(1d) \r\n    | where InstallationStatus != \"NotStarted\" \r\n    | summarize by Title, InstallationStatus, SourceComputerId, UpdateId, Computer\r\n) on UpdateId \r\n| where InstallationStatus1 != \"Succeed\"\r\n| summarize by Title, InstallationStatus, Computer, ResourceId\r\n",
                      "size": 2,
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ]
                    },
                    "name": "query - 13"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "InstallationFailureByMachine"
              },
              "name": "group - InstallationFailureByMachine"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "Scheduled Updates - Group",
                "items": [
                  {
                    "type": 1,
                    "content": {
                      "json": "## Automatic Updates Not Configured\r\n"
                    },
                    "name": "text - 17"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "// Automatic update configuration \r\n// Automatic update configuration. \r\n// To create an alert for this query, click '+ New alert rule'\r\nUpdateSummary\r\n| summarize AggregatedValue = count() by WindowsUpdateSetting, Computer, _ResourceId\r\n| order by WindowsUpdateSetting asc",
                      "size": 0,
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ],
                      "gridSettings": {
                        "formatters": [
                          {
                            "columnMatch": "WindowsUpdateSetting",
                            "formatter": 18,
                            "formatOptions": {
                              "thresholdsOptions": "colors",
                              "thresholdsGrid": [
                                {
                                  "operator": "!=",
                                  "thresholdValue": "Scheduled installation",
                                  "representation": "redBright",
                                  "text": "{0}{1}"
                                },
                                {
                                  "operator": "Default",
                                  "thresholdValue": null,
                                  "representation": "green",
                                  "text": "{0}{1}"
                                }
                              ]
                            }
                          }
                        ],
                        "labelSettings": [
                          {
                            "columnId": "_ResourceId",
                            "label": "Computer Name"
                          },
                          {
                            "columnId": "AggregatedValue",
                            "label": "Total Count In Logs"
                          }
                        ]
                      },
                      "sortBy": []
                    },
                    "name": "query - 18"
                  },
                  {
                    "type": 3,
                    "content": {
                      "version": "KqlItem/1.0",
                      "query": "// Automatic update configuration is disabled \r\n// Computers with automatic update disabled. \r\n// To create an alert for this query, click '+ New alert rule'\r\nUpdateSummary\r\n| where WindowsUpdateSetting == \"Manual\" \r\n| sort by TimeGenerated desc",
                      "size": 0,
                      "title": "Windows Updates Configured to \"Manual\"",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 0,
                      "resourceType": "microsoft.operationalinsights/workspaces",
                      "crossComponentResources": [
                        "{Workspaces}"
                      ]
                    },
                    "name": "query - 16"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "ScheduledUpdates"
              },
              "name": "group - Scheduled Updates"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "patchmanagement"
        },
        "name": "group - Patch Management"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "title": "Resource Overview",
          "items": [
            {
              "type": 11,
              "content": {
                "version": "LinkItem/1.0",
                "style": "tabs",
                "links": [
                  {
                    "id": "2c6ee711-70ac-4c99-950a-6c37bc0b1ff3",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "Orphaned Resources",
                    "subTarget": "OrphanedResources",
                    "style": "link"
                  },
                  {
                    "id": "89d27291-0add-4339-849c-ff23db6ff5fc",
                    "cellValue": "selectedTab",
                    "linkTarget": "parameter",
                    "linkLabel": "All Resources",
                    "subTarget": "All Resources",
                    "style": "link"
                  }
                ]
              },
              "name": "links - 0"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "items": [
                  {
                    "type": 11,
                    "content": {
                      "version": "LinkItem/1.0",
                      "style": "tabs",
                      "links": [
                        {
                          "id": "f321b3dd-4d96-4aa7-ac57-5ad8ce236a48",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Overview",
                          "subTarget": "overview",
                          "style": "link"
                        },
                        {
                          "id": "e79a9ba1-8aca-4e4a-9df7-83123cae1627",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Disks",
                          "subTarget": "disks",
                          "preText": "IaaS",
                          "style": "link"
                        },
                        {
                          "id": "ed3b708b-7054-424d-b32b-49451e04d36b",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Network Interfaces",
                          "subTarget": "nics",
                          "style": "link"
                        },
                        {
                          "id": "9bd4447c-8cac-4e8a-9f9b-bbcc99209b13",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Public IPs",
                          "subTarget": "pip",
                          "style": "link"
                        },
                        {
                          "id": "8192cd42-be72-4d18-b234-9e9fef4418dd",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Resource Groups",
                          "subTarget": "rg",
                          "style": "link"
                        },
                        {
                          "id": "1c2b6655-5c72-47bf-b4c6-9ea2665c07ef",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Network security groups",
                          "subTarget": "nsg",
                          "style": "link"
                        },
                        {
                          "id": "284d9e1f-d3f9-477e-8fac-0fad54c0b392",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Availability Set",
                          "subTarget": "avset",
                          "style": "link"
                        },
                        {
                          "id": "34ec8f14-78d1-4de2-871e-215c074cb377",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Route Tables",
                          "subTarget": "rt",
                          "style": "link"
                        },
                        {
                          "id": "fa15d6a8-daf2-43ac-a492-53b5749e3f9d",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Load Balancers",
                          "subTarget": "lb",
                          "style": "link"
                        },
                        {
                          "id": "cdc078fb-097b-44e0-bd07-547f8322b6cb",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "App Service Plans",
                          "subTarget": "appsp",
                          "style": "link"
                        }
                      ]
                    },
                    "name": "links - Tabs",
                    "styleSettings": {
                      "padding": "0 0 20px 0"
                    }
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Overview Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\"\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Disks",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "conditionalVisibility": {
                            "parameterName": "selectedTab",
                            "comparison": "isEqualTo",
                            "value": "overview"
                          },
                          "name": "query - Orphan Disks Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| where isnull(properties.privateEndpoint)\r\n| where isnull(properties.privateLinkService)\r\n| where properties.hostedWorkloads == \"[]\"\r\n| where properties !has 'virtualmachine'\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Network Interfaces",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Network Interfaces Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| where properties.ipConfiguration == \"\"\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total Public IPs",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Public IPs Count"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "overview"
                    },
                    "name": "group - Overview"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Disks Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\"\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Disks Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\"\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| extend SizeGB = tolong(properties.diskSizeGB)\r\n| summarize ['Total Disk Size (GB)']=sum(SizeGB)",
                            "size": 4,
                            "title": "Disks Size (GB)",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "Total Disk Size (GB)",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": []
                                  }
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Total Orphan Disk Size (GB)"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\"\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| summarize Count=count(type) by DiskType=tostring(sku.name)",
                            "size": 4,
                            "title": "Count by Disk Type",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Disks by DiskType"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\"\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| extend SizeGB = tolong(properties.diskSizeGB)\r\n| summarize SizeByDiskType=sum(SizeGB) by DiskType=tostring(sku.name)\r\n//| project DiskType, SizeByDiskType, DollarCost=(SizeByDiskType)*.13",
                            "size": 1,
                            "title": "Count by Disk Type",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "25",
                          "name": "query - Orphan Disks by DiskType - Copy"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" or diskState == 'Unattached'\r\n| where name !has \"-ASRReplica\"\r\n| extend Details = pack_all()\r\n| project id, resourceGroup, diskState, sku.name, properties.diskSizeGB, location, tags, subscriptionId, Details\r\n",
                            "size": 3,
                            "title": "Orphan Disks",
                            "noDataMessage": "No oprhan disks found",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              },
                              "sortBy": [
                                {
                                  "itemKey": "resourceGroup",
                                  "sortOrder": 2
                                }
                              ],
                              "labelSettings": [
                                {
                                  "columnId": "resourceGroup",
                                  "label": "Resource Group"
                                },
                                {
                                  "columnId": "diskState",
                                  "label": "Disk State"
                                },
                                {
                                  "columnId": "sku_name",
                                  "label": "Disk Type"
                                },
                                {
                                  "columnId": "properties_diskSizeGB",
                                  "label": "Disk Size (GB)"
                                },
                                {
                                  "columnId": "location",
                                  "label": "Location"
                                },
                                {
                                  "columnId": "tags",
                                  "label": "Tags"
                                },
                                {
                                  "columnId": "subscriptionId",
                                  "label": "Subscription"
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "resourceGroup",
                                "sortOrder": 2
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "name": "query - Orphan Disks"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "disks"
                    },
                    "name": "group - Disks"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Network Interfaces Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| where isnull(properties.privateEndpoint)\r\n| where isnull(properties.privateLinkService)\r\n| where properties.hostedWorkloads == \"[]\"\r\n| where properties !has 'virtualmachine'\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Network Interfaces Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| where isnull(properties.privateEndpoint)\r\n| where isnull(properties.privateLinkService)\r\n| where properties.hostedWorkloads == \"[]\"\r\n| where properties !has 'virtualmachine'\r\n| summarize count(type) by location",
                            "size": 4,
                            "title": "Count by Location",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Network Interfaces by Location"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| where isnull(properties.privateEndpoint)\r\n| where isnull(properties.privateLinkService)\r\n| where properties !has 'virtualmachine'\r\n| extend Details = pack_all()\r\n| project Resource=id, resourceGroup, location, tags, subscriptionId, Details",
                            "size": 3,
                            "title": "Orphan Network Interfaces",
                            "noDataMessage": "No oprhan Network Interfaces found",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "linkIsContextBlade": true,
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "Resource",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "Resource"
                              },
                              "sortBy": [
                                {
                                  "itemKey": "resourceGroup",
                                  "sortOrder": 2
                                }
                              ],
                              "labelSettings": [
                                {
                                  "columnId": "resourceGroup",
                                  "label": "Resource Group"
                                },
                                {
                                  "columnId": "location",
                                  "label": "Location"
                                },
                                {
                                  "columnId": "tags",
                                  "label": "Tags"
                                },
                                {
                                  "columnId": "subscriptionId",
                                  "label": "Subscription"
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "resourceGroup",
                                "sortOrder": 2
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "name": "query - Orphan Network Interfaces"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "nics"
                    },
                    "name": "group - Network Interfaces"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Public IPs Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| where properties.ipConfiguration == \"\"\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Public IPs Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| where properties.ipConfiguration == \"\"\r\n| summarize count(type) by tostring(sku.name)",
                            "size": 4,
                            "title": "Count by Type",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Public IPs by Type"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| where properties.ipConfiguration == \"\"\r\n| summarize count(type) by location",
                            "size": 4,
                            "title": "Count by Location",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Public IPs by Location"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| where properties.ipConfiguration == \"\"\r\n| extend Details = pack_all()\r\n| project Resource=id, resourceGroup, location, subscriptionId, sku.name, tags ,Details",
                            "size": 3,
                            "title": "Orphan Public IPs",
                            "noDataMessage": "No oprhan Public IPs found",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "linkIsContextBlade": true,
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "Resource",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "Resource"
                              },
                              "sortBy": [
                                {
                                  "itemKey": "resourceGroup",
                                  "sortOrder": 2
                                }
                              ],
                              "labelSettings": [
                                {
                                  "columnId": "Resource",
                                  "label": "Public IP Name"
                                },
                                {
                                  "columnId": "resourceGroup",
                                  "label": "Resource Group"
                                },
                                {
                                  "columnId": "location",
                                  "label": "Location"
                                },
                                {
                                  "columnId": "subscriptionId",
                                  "label": "Subscription"
                                },
                                {
                                  "columnId": "sku_name",
                                  "label": "Type"
                                },
                                {
                                  "columnId": "tags",
                                  "label": "Tags"
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "resourceGroup",
                                "sortOrder": 2
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "name": "query - Orphan Public IPs"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "pip"
                    },
                    "name": "group - pip Group"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "OrphanedResources"
              },
              "name": "group - OrphanedResources"
            },
            {
              "type": 12,
              "content": {
                "version": "NotebookGroup/1.0",
                "groupType": "editable",
                "title": "All Resources",
                "items": [
                  {
                    "type": 11,
                    "content": {
                      "version": "LinkItem/1.0",
                      "style": "tabs",
                      "links": [
                        {
                          "id": "f321b3dd-4d96-4aa7-ac57-5ad8ce236a48",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Overview",
                          "subTarget": "overview",
                          "style": "link"
                        },
                        {
                          "id": "85e269c7-72fd-465c-b0ee-60958dfe2fb5",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "VMs",
                          "subTarget": "VMs",
                          "style": "link"
                        },
                        {
                          "id": "e79a9ba1-8aca-4e4a-9df7-83123cae1627",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Disks",
                          "subTarget": "disks",
                          "preText": "IaaS",
                          "style": "link"
                        },
                        {
                          "id": "ed3b708b-7054-424d-b32b-49451e04d36b",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Network Interfaces",
                          "subTarget": "nics",
                          "style": "link"
                        },
                        {
                          "id": "9bd4447c-8cac-4e8a-9f9b-bbcc99209b13",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Public IPs",
                          "subTarget": "pip",
                          "style": "link"
                        },
                        {
                          "id": "8192cd42-be72-4d18-b234-9e9fef4418dd",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Resource Groups",
                          "subTarget": "rg",
                          "style": "link"
                        },
                        {
                          "id": "1c2b6655-5c72-47bf-b4c6-9ea2665c07ef",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Network security groups",
                          "subTarget": "nsg",
                          "style": "link"
                        },
                        {
                          "id": "284d9e1f-d3f9-477e-8fac-0fad54c0b392",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Availability Set",
                          "subTarget": "avset",
                          "style": "link"
                        },
                        {
                          "id": "34ec8f14-78d1-4de2-871e-215c074cb377",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Route Tables",
                          "subTarget": "rt",
                          "style": "link"
                        },
                        {
                          "id": "fa15d6a8-daf2-43ac-a492-53b5749e3f9d",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "Load Balancers",
                          "subTarget": "lb",
                          "style": "link"
                        },
                        {
                          "id": "cdc078fb-097b-44e0-bd07-547f8322b6cb",
                          "cellValue": "selectedTab",
                          "linkTarget": "parameter",
                          "linkLabel": "App Service Plans",
                          "subTarget": "appsp",
                          "style": "link"
                        }
                      ]
                    },
                    "name": "links - Tabs",
                    "styleSettings": {
                      "padding": "0 0 20px 0"
                    }
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Overview Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Virtual Machines",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "conditionalVisibility": {
                            "parameterName": "selectedTab",
                            "comparison": "isEqualTo",
                            "value": "overview"
                          },
                          "name": "query - Orphan Disks Count - Copy"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n//| where managedBy == \"\"\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Disks",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "conditionalVisibility": {
                            "parameterName": "selectedTab",
                            "comparison": "isEqualTo",
                            "value": "overview"
                          },
                          "name": "query - Orphan Disks Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Network Interfaces",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Network Interfaces Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total Public IPs",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Public IPs Count"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "overview"
                    },
                    "name": "group - Overview"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| project name, Status=properties.extended.instanceView.powerState.displayStatus, location, resourceGroup, vmSize=properties.hardwareProfile.vmSize, DiskSize=properties.storageProfile.osDisk.diskSizeGB, DiskSku=properties.storageProfile.osDisk.managedDisk.storageAccountType, DiskCaching=properties.storageProfile.osDisk.caching, OS=properties.extended.instanceView.osName, OSVersion=properties.extended.instanceView.osVersion, LicenseType=properties.licenseType, subscriptionId\r\n| join kind=inner (\r\n    resourcecontainers\r\n    | where type == 'microsoft.resources/subscriptions'\r\n    | project subscriptionId, subscriptionName = name)\r\n    on subscriptionId\r\n| project subscriptionName, name, Status, location, resourceGroup, vmSize, DiskSize, DiskSku, OS, OSVersion, LicenseType, subscriptionId\r\n| sort by subscriptionName\r\n",
                            "size": 3,
                            "title": "Virtual Machines in Subscription",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "table",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "Status",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "VM running",
                                        "representation": "redBright",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      }
                                    ],
                                    "customColumnWidthSetting": "18ch"
                                  }
                                },
                                {
                                  "columnMatch": "location",
                                  "formatter": 0,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "18ch"
                                  }
                                },
                                {
                                  "columnMatch": "resourceGroup",
                                  "formatter": 0,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "20ch"
                                  }
                                },
                                {
                                  "columnMatch": "vmSize",
                                  "formatter": 1
                                },
                                {
                                  "columnMatch": "DiskSize",
                                  "formatter": 1,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "14ch"
                                  }
                                },
                                {
                                  "columnMatch": "DiskSku",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "==",
                                        "thresholdValue": "StandardSSD_LRS",
                                        "representation": "lightBlue",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "==",
                                        "thresholdValue": "Premium_LRS",
                                        "representation": "green",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "==",
                                        "thresholdValue": "Standard_LRS",
                                        "representation": "yellow",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "DiskCaching",
                                  "formatter": 1
                                },
                                {
                                  "columnMatch": "OS",
                                  "formatter": 1,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "20ch"
                                  }
                                },
                                {
                                  "columnMatch": "LicenseType",
                                  "formatter": 1,
                                  "formatOptions": {
                                    "customColumnWidthSetting": "20ch"
                                  }
                                },
                                {
                                  "columnMatch": "Azure Spot Eviction Policy",
                                  "formatter": 18,
                                  "formatOptions": {
                                    "thresholdsOptions": "colors",
                                    "thresholdsGrid": [
                                      {
                                        "operator": "!=",
                                        "thresholdValue": "deallocate",
                                        "representation": "orange",
                                        "text": "{0}{1}"
                                      },
                                      {
                                        "operator": "Default",
                                        "thresholdValue": null,
                                        "text": "{0}{1}"
                                      }
                                    ]
                                  }
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "sortBy": [
                                {
                                  "itemKey": "vmSize",
                                  "sortOrder": 1
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "vmSize",
                                "sortOrder": 1
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmState",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "count_",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": false,
                                    "maximumFractionDigits": 2,
                                    "maximumSignificantDigits": 3
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "showPin": true,
                          "name": "query - Azure Compute Summary - Copy - Copy"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "VMs"
                    },
                    "name": "group - VMs"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Disks Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Disks Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| extend SizeGB = tolong(properties.diskSizeGB)\r\n| summarize ['Total Disk Size (GB)']=sum(SizeGB)",
                            "size": 4,
                            "title": "Disks Size (GB)",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "Total Disk Size (GB)",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": []
                                  }
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Total Orphan Disk Size (GB)"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| summarize Count=count(type) by DiskType=tostring(sku.name)",
                            "size": 4,
                            "title": "Count by Disk Type",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Disks by DiskType"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where not(name endswith \"-ASRReplica\" or name startswith \"ms-asr-\")\r\n| extend SizeGB = tolong(properties.diskSizeGB)\r\n| summarize SizeByDiskType=sum(SizeGB) by DiskType=tostring(sku.name)\r\n//| project DiskType, SizeByDiskType, DollarCost=(SizeByDiskType)*.13",
                            "size": 1,
                            "title": "Count by Disk Type",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "25",
                          "name": "query - Orphan Disks by DiskType - Copy"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.compute/disks\"\r\n| extend diskState = tostring(properties.diskState)\r\n| where name !has \"-ASRReplica\"\r\n| extend Details = pack_all()\r\n| project id, resourceGroup, diskState, sku.name, properties.diskSizeGB, location, tags, subscriptionId, Details\r\n",
                            "size": 3,
                            "title": "Orphan Disks",
                            "noDataMessage": "No oprhan disks found",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              },
                              "sortBy": [
                                {
                                  "itemKey": "resourceGroup",
                                  "sortOrder": 2
                                }
                              ],
                              "labelSettings": [
                                {
                                  "columnId": "resourceGroup",
                                  "label": "Resource Group"
                                },
                                {
                                  "columnId": "diskState",
                                  "label": "Disk State"
                                },
                                {
                                  "columnId": "sku_name",
                                  "label": "Disk Type"
                                },
                                {
                                  "columnId": "properties_diskSizeGB",
                                  "label": "Disk Size (GB)"
                                },
                                {
                                  "columnId": "location",
                                  "label": "Location"
                                },
                                {
                                  "columnId": "tags",
                                  "label": "Tags"
                                },
                                {
                                  "columnId": "subscriptionId",
                                  "label": "Subscription"
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "resourceGroup",
                                "sortOrder": 2
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "name": "query - Orphan Disks"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "disks"
                    },
                    "name": "group - Disks"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Network Interfaces Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| where properties !has 'virtualmachine'\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Network Interfaces Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| where properties !has 'virtualmachine'\r\n| summarize count(type) by location",
                            "size": 4,
                            "title": "Count by Location",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Network Interfaces by Location"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type has \"microsoft.network/networkinterfaces\"\r\n| extend Details = pack_all()\r\n| project Resource=id, resourceGroup, location, tags, subscriptionId, Details",
                            "size": 3,
                            "title": "Orphan Network Interfaces",
                            "noDataMessage": "No oprhan Network Interfaces found",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "linkIsContextBlade": true,
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "Resource",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "Resource"
                              },
                              "sortBy": [
                                {
                                  "itemKey": "resourceGroup",
                                  "sortOrder": 2
                                }
                              ],
                              "labelSettings": [
                                {
                                  "columnId": "resourceGroup",
                                  "label": "Resource Group"
                                },
                                {
                                  "columnId": "location",
                                  "label": "Location"
                                },
                                {
                                  "columnId": "tags",
                                  "label": "Tags"
                                },
                                {
                                  "columnId": "subscriptionId",
                                  "label": "Subscription"
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "resourceGroup",
                                "sortOrder": 2
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "name": "query - Orphan Network Interfaces"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "nics"
                    },
                    "name": "group - Network Interfaces"
                  },
                  {
                    "type": 12,
                    "content": {
                      "version": "NotebookGroup/1.0",
                      "groupType": "editable",
                      "title": "Public IPs Group",
                      "items": [
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| summarize count(type)",
                            "size": 4,
                            "title": "Total",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "tiles",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "count_type",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                }
                              },
                              "showBorder": true,
                              "sortOrderField": 2,
                              "size": "auto"
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "textSettings": {
                              "style": "bignumber"
                            }
                          },
                          "customWidth": "15",
                          "name": "query - Orphan Public IPs Count"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| summarize count(type) by tostring(sku.name)",
                            "size": 4,
                            "title": "Count by Type",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Public IPs by Type"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| summarize count(type) by location",
                            "size": 4,
                            "title": "Count by Location",
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "visualization": "piechart",
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "id",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "id"
                              }
                            },
                            "sortBy": [],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "DiskType",
                                "formatter": 1
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto"
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            },
                            "chartSettings": {
                              "showMetrics": false,
                              "showLegend": true
                            },
                            "mapSettings": {
                              "locInfo": "LatLong",
                              "sizeSettings": "Count",
                              "sizeAggregation": "Sum",
                              "legendMetric": "Count",
                              "legendAggregation": "Sum",
                              "itemColorSettings": {
                                "type": "heatmap",
                                "colorAggregation": "Sum",
                                "nodeColorField": "Count",
                                "heatmapPalette": "greenRed"
                              }
                            }
                          },
                          "customWidth": "30",
                          "name": "query - Orphan Public IPs by Location"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "Resources\r\n| where type == \"microsoft.network/publicipaddresses\"\r\n| extend Details = pack_all()\r\n| project Resource=id, resourceGroup, location, subscriptionId, sku.name, tags ,Details",
                            "size": 3,
                            "title": "Orphan Public IPs",
                            "noDataMessage": "No oprhan Public IPs found",
                            "showExportToExcel": true,
                            "queryType": 1,
                            "resourceType": "microsoft.resourcegraph/resources",
                            "crossComponentResources": [
                              "{Subscriptions}"
                            ],
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "$gen_group",
                                  "formatter": 13,
                                  "formatOptions": {
                                    "linkTarget": "Resource",
                                    "linkIsContextBlade": true,
                                    "showIcon": true
                                  }
                                },
                                {
                                  "columnMatch": "Resource",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "subscriptionId",
                                  "formatter": 5
                                },
                                {
                                  "columnMatch": "Details",
                                  "formatter": 7,
                                  "formatOptions": {
                                    "linkTarget": "CellDetails",
                                    "linkLabel": " View Details",
                                    "linkIsContextBlade": true
                                  }
                                }
                              ],
                              "rowLimit": 1000,
                              "filter": true,
                              "hierarchySettings": {
                                "treeType": 1,
                                "groupBy": [
                                  "subscriptionId"
                                ],
                                "expandTopLevel": true,
                                "finalBy": "Resource"
                              },
                              "sortBy": [
                                {
                                  "itemKey": "resourceGroup",
                                  "sortOrder": 2
                                }
                              ],
                              "labelSettings": [
                                {
                                  "columnId": "Resource",
                                  "label": "Public IP Name"
                                },
                                {
                                  "columnId": "resourceGroup",
                                  "label": "Resource Group"
                                },
                                {
                                  "columnId": "location",
                                  "label": "Location"
                                },
                                {
                                  "columnId": "subscriptionId",
                                  "label": "Subscription"
                                },
                                {
                                  "columnId": "sku_name",
                                  "label": "Type"
                                },
                                {
                                  "columnId": "tags",
                                  "label": "Tags"
                                }
                              ]
                            },
                            "sortBy": [
                              {
                                "itemKey": "resourceGroup",
                                "sortOrder": 2
                              }
                            ],
                            "tileSettings": {
                              "titleContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              },
                              "leftContent": {
                                "columnMatch": "Count",
                                "formatter": 12,
                                "formatOptions": {
                                  "palette": "auto",
                                  "showIcon": true
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              "showBorder": true
                            },
                            "graphSettings": {
                              "type": 0,
                              "topContent": {
                                "columnMatch": "vmSize",
                                "formatter": 1
                              },
                              "centerContent": {
                                "columnMatch": "Count",
                                "formatter": 1,
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "maximumSignificantDigits": 3,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              }
                            }
                          },
                          "name": "query - Orphan Public IPs"
                        }
                      ]
                    },
                    "conditionalVisibility": {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "pip"
                    },
                    "name": "group - pip Group"
                  }
                ]
              },
              "conditionalVisibility": {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "All Resources"
              },
              "name": "group - All Resources"
            }
          ]
        },
        "conditionalVisibility": {
          "parameterName": "selectedTab",
          "comparison": "isEqualTo",
          "value": "ResourceOverview"
        },
        "name": "group - ResourceOverview",
        "styleSettings": {
          "showBorder": true
        }
      },
      {
        "type": 1,
        "content": {
          "json": "Original Source - Azure Monitor Insights Inventory Workbook\r\n<br/>\r\nWorkbook Manager - Blair Sonnnek - blair.sonnek@netapp.com",
          "style": "info"
        },
        "name": "text - 107"
      }
    ],
    "fallbackResourceIds": [
      "Azure Monitor"
    ],
    "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
  }